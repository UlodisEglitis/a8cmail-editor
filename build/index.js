(()=>{var e={744:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===a}(e)}(e)},a="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?r((a=e,Array.isArray(a)?[]:{}),e,t):e;var a}function l(e,t,a){return e.concat(t).map((function(e){return n(e,a)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function i(e,t){try{return t in e}catch(e){return!1}}function r(e,a,s){(s=s||{}).arrayMerge=s.arrayMerge||l,s.isMergeableObject=s.isMergeableObject||t,s.cloneUnlessOtherwiseSpecified=n;var c=Array.isArray(a);return c===Array.isArray(e)?c?s.arrayMerge(e,a,s):function(e,t,a){var l={};return a.isMergeableObject(e)&&o(e).forEach((function(t){l[t]=n(e[t],a)})),o(t).forEach((function(o){(function(e,t){return i(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(i(e,o)&&a.isMergeableObject(t[o])?l[o]=function(e,t){if(!t.customMerge)return r;var a=t.customMerge(e);return"function"==typeof a?a:r}(o,a)(e[o],t[o],a):l[o]=n(t[o],a))})),l}(e,a,s):n(a,s)}r.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,a){return r(e,a,t)}),{})};var s=r;e.exports=s},20:(e,t,a)=>{"use strict";var n=a(609),l=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,a){var n,o={},c=null,m=null;for(n in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(m=t.ref),t)i.call(t,n)&&!s.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:l,type:e,key:c,ref:m,props:o,_owner:r.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},848:(e,t,a)=>{"use strict";e.exports=a(20)},609:e=>{"use strict";e.exports=window.React},942:(e,t)=>{var a;!function(){"use strict";var n={}.hasOwnProperty;function l(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=i(e,o(a)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return l.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)n.call(e,a)&&e[a]&&(t=i(t,a));return t}function i(e,t){return t?e?e+" "+t:e+t:e}e.exports?(l.default=l,e.exports=l):void 0===(a=function(){return l}.apply(t,[]))||(e.exports=a)}()}},t={};function a(n){var l=t[n];if(void 0!==l)return l.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};a.r(e),a.d(e,{closeModal:()=>Be,disableComplementaryArea:()=>xe,enableComplementaryArea:()=>Se,openModal:()=>Me,pinItem:()=>Ce,setDefaultComplementaryArea:()=>ke,setFeatureDefaults:()=>Ie,setFeatureValue:()=>Pe,toggleFeature:()=>Ne,unpinItem:()=>Te});var t={};a.r(t),a.d(t,{getActiveComplementaryArea:()=>Ae,isComplementaryAreaLoading:()=>Le,isFeatureActive:()=>ze,isItemPinned:()=>Re,isModalActive:()=>Fe});var n={};a.r(n),a.d(n,{changePreviewDeviceType:()=>dn,closeSidebar:()=>fn,openSidebar:()=>yn,requestSendingNewsletterPreview:()=>kn,revertAndSaveTemplate:()=>Sn,saveEditedEmail:()=>bn,setIsFetchingPersonalizationTags:()=>xn,setPersonalizationTagsList:()=>Cn,setTemplateToPost:()=>wn,toggleFeature:()=>pn,togglePersonalizationTagsModal:()=>gn,togglePreviewModal:()=>un,toggleSettingsSidebarActiveTab:()=>En,updateEmailMailPoetProperty:()=>vn,updateSendPreviewEmail:()=>hn});var l={};a.r(l),a.d(l,{getAutosaveInterval:()=>el,getCdnUrl:()=>tl,getCurrentTemplate:()=>Vn,getCurrentTemplateContent:()=>Hn,getDeviceType:()=>Xn,getEditedEmailContent:()=>jn,getEditedPostTemplate:()=>On,getEmailPostId:()=>Un,getEmailTemplates:()=>$n,getGlobalEmailStylesPost:()=>Gn,getGlobalStylesPostId:()=>ll,getInitialEditorSettings:()=>qn,getPaletteColors:()=>Zn,getPersonalizationTagsList:()=>Kn,getPersonalizationTagsState:()=>Jn,getPreviewState:()=>Yn,getSentEmailEditorPosts:()=>Dn,getSettingsSidebarActiveTab:()=>Wn,getStyles:()=>Qn,getTheme:()=>nl,getUrls:()=>ol,hasEdits:()=>Bn,hasEmptyContent:()=>zn,isEmailLoaded:()=>An,isEmailSent:()=>Fn,isEmpty:()=>Rn,isFeatureActive:()=>In,isPremiumPluginActive:()=>al,isSaving:()=>Ln,isSidebarOpened:()=>Mn});var o={};a.r(o),a.d(o,{getPersonalizationTagsList:()=>il});var i=a(609);window.wp.formatLibrary;const r=window.wp.data,s=window.wp.element,c=window.wp.hooks,m=window.wp.blockLibrary,p=window.wp.blockEditor,d=window.wp.compose,u=(0,d.createHigherOrderComponent)((e=>function(t){return"core/columns"!==t.name?(0,i.createElement)(e,{...t}):(0,i.createElement)(i.Fragment,null,(0,i.createElement)(e,{...t}),(0,i.createElement)(p.InspectorControls,null,(0,i.createElement)("style",null,"\n      .components-panel__body .components-toggle-control .components-form-toggle { opacity: 0.3; }\n      .components-panel__body .components-toggle-control .components-form-toggle__input { pointer-events: none; }\n      .components-panel__body .components-toggle-control label { pointer-events: none; }\n    ")))}),"columnsEditCallback"),_=window.wp.i18n;function g({layoutClassNames:e}){const t=(0,p.useBlockProps)({className:e});return(0,i.createElement)("div",{...t},(0,i.createElement)("p",null,(0,_.__)("This is the Content block.","mailpoet")),(0,i.createElement)("p",null,(0,_.__)("It will display all the blocks in the email content, which might be only simple text paragraphs. You can enrich your message with images, incorporate data through tables, explore different layout designs with columns, or use any other block type.","mailpoet")))}const h=(0,d.createHigherOrderComponent)((e=>function(t){return"core/image"!==t.name?(0,i.createElement)(e,{...t}):(0,i.createElement)(i.Fragment,null,(0,i.createElement)(e,{...t}),(0,i.createElement)(p.InspectorControls,null,(0,i.createElement)("style",null,"\n        .components-tools-panel .components-toggle-control { display: none; }\n      ")))}),"imageEditCallback"),y=window.wp.richText,f=window.wp.components,E=(e,t)=>{const a=e.current.ownerDocument.defaultView.getSelection();if(!a.rangeCount)return{start:0,end:0};const n=a.getRangeAt(0);if(null===a.anchorNode.previousSibling)return{start:a.anchorOffset,end:a.anchorOffset+n.toString().length};const l=(0,y.create)({html:t});let o=a.anchorNode.previousSibling;o=function(e){let t=e;for(;t&&t.children.length>0;)t=t.children[0];return t}(o);const i=function(e,t){let a=null;for(const[n,l]of t.entries())if(l)for(const t of l)t?.attributes&&e.tagName.toLowerCase()===t.tagName?.toLowerCase()&&e.getAttribute("data-link-href")===t?.attributes["data-link-href"]&&(a=n);return a}(o,l.formats);if(null!==i)return{start:i+a.anchorOffset+1,end:i+a.anchorOffset+n.toString().length};const r=function(e,t){for(const[a,n]of t.entries()){if(!n)continue;const{attributes:t}=n;if(e.getAttribute("data-rich-text-comment")===t["data-rich-text-comment"])return a}return null}(o,l.replacements);return null!==r?{start:r+a.anchorOffset+1,end:r+a.anchorOffset+n.toString().length}:{start:l.text.length,end:l.text.length+n.toString().length}},b=(e,t)=>(t.forEach((t=>{if(!e.includes(t.token.slice(0,t.token.length-1)))return;const a=t.token.substring(1,t.token.length-1).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=new RegExp(`(?<!\x3c!--)(?<!["'])\\[(${a}(\\s[^\\]]*)?)\\](?!--\x3e)`,"g");e=e.replace(n,(e=>`\x3c!--${e}--\x3e`))})),e),v="email-editor/editor",w="document",k="block",S=({groupedTags:e,activeCategory:t,onCategorySelect:a})=>{const n=e=>e===t?"mailpoet-personalization-tags-modal__menu-item-active":"";return(0,i.createElement)(f.MenuGroup,{className:"mailpoet-personalization-tags-modal__menu"},(0,i.createElement)(f.MenuItem,{onClick:()=>a(null),className:n(null)},(0,_.__)("All")),(0,i.createElement)("div",{className:"mailpoet-personalization-tags-modal__menu-separator","aria-hidden":"true"}),Object.keys(e).map(((e,t,l)=>(0,i.createElement)(s.Fragment,{key:e},(0,i.createElement)(f.MenuItem,{onClick:()=>a(e),className:n(e)},e),t<l.length-1&&(0,i.createElement)("div",{className:"mailpoet-personalization-tags-modal__menu-separator","aria-hidden":"true"})))))},x=({groupedTags:e,activeCategory:t,onInsert:a,canInsertLink:n,closeCallback:l,openLinkModal:o})=>{const r=null===t?Object.entries(e):[[t,e[t]||[]]];return(0,i.createElement)(i.Fragment,null,r.map((([e,t])=>(0,i.createElement)("div",{key:e},(0,i.createElement)("div",{className:"mailpoet-personalization-tags-modal__category"},e),(0,i.createElement)("div",{className:"mailpoet-personalization-tags-modal__category-group"},t.map((t=>(0,i.createElement)("div",{className:"mailpoet-personalization-tags-modal__category-group-item",key:t.token},(0,i.createElement)("div",{className:"mailpoet-personalization-tags-modal__item-text"},(0,i.createElement)("strong",null,t.name),t.valueToInsert),(0,i.createElement)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"}},(0,i.createElement)(f.Button,{variant:"link",onClick:()=>{a&&a(t.token,!1)}},(0,_.__)("Insert")),e===(0,_.__)("Link")&&n&&(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.Button,{variant:"link",onClick:()=>{l(),o(t)}},(0,_.__)("Insert as link"))))))))))))},C=({onInsert:e,isOpened:t,closeCallback:a,tag:n})=>{const[l,o]=(0,s.useState)((0,_.__)("Link","mailpoet"));return t?(0,i.createElement)(f.Modal,{size:"small",title:(0,_.__)("Insert Link","mailpoet"),onRequestClose:a,className:"mailpoet-personalization-tags-modal"},(0,i.createElement)(f.TextControl,{label:(0,_.__)("Link Text","mailpoet"),value:l,onChange:o}),(0,i.createElement)(f.Button,{isPrimary:!0,onClick:()=>{e&&e(n.token,l)}},(0,_.__)("Insert"))):null},T=window.lodash,N=(0,c.applyFilters)("mailpoet_email_editor_events_tracking_enabled",!1),P="email_editor_events",I=new EventTarget,M=(e,t={})=>{if(!N)return;const a={name:`${P}_${e}`,..."object"!=typeof t?{data:t}:t};I.dispatchEvent(new CustomEvent(P,{detail:a}))},B=function(){const e={};return(t,a={})=>{if(!N)return;const n=`${t}_${JSON.stringify(a).length}`;e[n]||(M(t,a),e[n]=!0)}}(),A=(0,T.debounce)(M,700),L=({onInsert:e,isOpened:t,closeCallback:a,canInsertLink:n=!1,openedBy:l=""})=>{const[o,c]=(0,s.useState)(null),[m,p]=(0,s.useState)(""),[d,u]=(0,s.useState)(null),[g,h]=(0,s.useState)(!1),y=(0,r.useSelect)((e=>e(v).getPersonalizationTagsList()),[]);if(g)return(0,i.createElement)(C,{onInsert:(t,a)=>{e(t,a),h(!1)},isOpened:g,closeCallback:()=>h(!1),tag:d});if(!t)return null;B("personalization_tags_modal_opened",{openedBy:l});const E=y.reduce(((e,t)=>{const{category:a,name:n,token:l}=t;return(!m||n.toLowerCase().includes(m.toLowerCase())||l.toLowerCase().includes(m.toLowerCase()))&&(e[a]||(e[a]=[]),e[a].push(t)),e}),{});return(0,i.createElement)(f.Modal,{size:"medium",title:(0,_.__)("Personalization Tags","mailpoet"),onRequestClose:()=>{a(),M("personalization_tags_modal_closed",{openedBy:l})},className:"mailpoet-personalization-tags-modal"},(0,i.createElement)("p",null,(0,_.__)("Insert personalization tags to dynamically fill in information and personalize your emails.","mailpoet")," ",(0,i.createElement)(f.ExternalLink,{href:"https://kb.mailpoet.com/article/435-a-guide-to-personalisation-tags-for-tailored-newsletters#list",onClick:()=>M("personalization_tags_modal_learn_more_link_clicked",{openedBy:l})},(0,_.__)("Learn more","mailpoet"))),(0,i.createElement)(f.SearchControl,{onChange:e=>{p(e),B("personalization_tags_modal_search_control_input_updated",{openedBy:l})},value:m}),(0,i.createElement)(S,{groupedTags:E,activeCategory:o,onCategorySelect:e=>{c(e),M("personalization_tags_modal_category_menu_clicked",{category:e,openedBy:l})}}),(0,i.createElement)(x,{groupedTags:E,activeCategory:o,onInsert:t=>{e(t),M("personalization_tags_modal_tag_insert_button_clicked",{insertedTag:t,activeCategory:o,openedBy:l})},closeCallback:a,canInsertLink:n,openLinkModal:e=>{u(e),h(!0)}}))},R=({contentRef:e,onUpdate:t})=>{const[a,n]=(0,s.useState)(!1),[l,o]=(0,s.useState)(null),[r,c]=(0,s.useState)(""),[m,p]=(0,s.useState)("");return(0,s.useEffect)((()=>{if(!e||!e.current)return;const t=e.current,a=e=>{const t=e.target.closest("span[data-rich-text-comment]");if(t){const e=t.innerText.replace(/^\[|\]$/g,"");p(e),c(e),o(t),n(!0)}};return t.addEventListener("click",a),()=>{t.removeEventListener("click",a)}}),[e]),(0,i.createElement)(i.Fragment,null,a&&l&&(0,i.createElement)(f.Popover,{position:"bottom right",onClose:()=>n(!1),anchor:l,className:"mailpoet-personalization-tag-popover"},(0,i.createElement)("div",{className:"mailpoet-personalization-tag-popover__content"},(0,i.createElement)(f.TextControl,{label:(0,_.__)("Personalization Tag","mailpoet"),value:r,onChange:e=>c(e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,i.createElement)("div",{className:"mailpoet-personalization-tag-popover__content-buttons"},(0,i.createElement)(f.Button,{isTertiary:!0,onClick:()=>{n(!1)}},(0,_.__)("Cancel","mailpoet")),(0,i.createElement)(f.Button,{isPrimary:!0,onClick:()=>{t(m,r),n(!1)}},(0,_.__)("Update","mailpoet"))))))},z=({contentRef:e,onUpdate:t})=>{const[a,n]=(0,s.useState)(!1),[l,o]=(0,s.useState)(null),[c,m]=(0,s.useState)(""),[p,d]=(0,s.useState)(""),u=(0,r.useSelect)((e=>e(v).getPersonalizationTagsList()),[]);return(0,s.useEffect)((()=>{if(!e||!e.current)return;const t=e.current,a=e=>{const t=e.target.closest("a[data-link-href]");t&&(o(t),d(t.getAttribute("data-link-href")||""),m(t.textContent||""),n(!0))};return t.addEventListener("click",a),()=>{t.removeEventListener("click",a)}}),[e]),(0,i.createElement)(i.Fragment,null,a&&l&&(0,i.createElement)(f.Popover,{position:"bottom left",onClose:()=>n(!1),anchor:l,className:"mailpoet-personalization-tag-popover"},(0,i.createElement)("div",{className:"mailpoet-personalization-tag-popover__content"},(0,i.createElement)(f.TextControl,{label:(0,_.__)("Link Text","mailpoet"),value:c,onChange:e=>m(e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,autoComplete:"off"}),(0,i.createElement)(f.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,_.__)("Link tag","mailpoet"),value:p,onChange:e=>{d(e)},options:u.filter((e=>e.category===(0,_.__)("Link","mailpoet"))).map((e=>({label:e.name,value:e.token})))}),(0,i.createElement)("div",{className:"mailpoet-personalization-tag-popover__content-buttons"},(0,i.createElement)(f.Button,{isTertiary:!0,onClick:()=>{n(!1)}},(0,_.__)("Cancel","mailpoet")),(0,i.createElement)(f.Button,{isPrimary:!0,onClick:()=>{n(!1),t(l,p,c)}},(0,_.__)("Update link","mailpoet"))))))};function F({contentRef:e}){const[t,a]=(0,s.useState)(!1),n=(0,r.useSelect)((e=>e("core/block-editor").getSelectedBlockClientId())),{updateBlockAttributes:l}=(0,r.useDispatch)("core/block-editor"),o=(0,r.useSelect)((e=>{const t=e("core/block-editor").getBlockAttributes(n);return t?.content?.originalHTML||t?.content||""})),c=(0,s.useCallback)(((t,a)=>{let{start:i,end:r}=E(e,o),s="";if(a){let e=(0,y.create)({html:o});e=(0,y.insert)(e,a,i,r),r=i+a.length,e=(0,y.applyFormat)(e,{type:"mailpoet-email-editor/link-shortcode",attributes:{"data-link-href":t,contenteditable:"false",style:"text-decoration: underline;"}},i,r),s=(0,y.toHTMLString)({value:e})}else{let e=(0,y.create)({html:o});e=(0,y.insert)(e,(0,y.create)({html:`\x3c!--${t}--\x3e&nbsp;`}),i,r),s=(0,y.toHTMLString)({value:e})}l(n,{content:s})}),[o,e,n,l]);return(0,i.createElement)(p.BlockControls,null,(0,i.createElement)(f.ToolbarGroup,null,(0,i.createElement)(f.ToolbarButton,{icon:"shortcode",title:(0,_.__)("Personalization Tags","mailpoet"),onClick:()=>{a(!0),M("block_controls_personalization_tags_button_clicked")}}),(0,i.createElement)(R,{contentRef:e,onUpdate:(e,t)=>{const a=o.replace(`\x3c!--[${e}]--\x3e`,`\x3c!--[${t}]--\x3e`);l(n,{content:a})}}),(0,i.createElement)(z,{contentRef:e,onUpdate:(e,t,a)=>{const i=e.getAttribute("data-link-href").replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp(`<a([^>]*?)data-link-href="${i}"([^>]*?)>${e.textContent}</a>`,"gi"),s=o.replace(r,((e,n,l)=>`<a${n}data-link-href="${t}"${l}>${a}</a>`));l(n,{content:s})}}),(0,i.createElement)(L,{isOpened:t,onInsert:(e,t)=>{c(e,t),a(!1)},closeCallback:()=>a(!1),canInsertLink:!0,openedBy:"block-controls"})))}const j=(0,d.createHigherOrderComponent)((e=>t=>{const{attributes:a,setAttributes:n,name:l}=t,{content:o}=a,c=(0,r.useSelect)((e=>e(v).getPersonalizationTagsList()),[]),m=(0,s.useCallback)((()=>o?b(o,c):""),[o,c]),p=(0,s.useCallback)((e=>{if(void 0!==e.content){const t=b(e.content,c);n({...e,content:t})}else n(e)}),[c,n]);return"core/paragraph"===l||"core/heading"===l||"core/list-item"===l?(0,i.createElement)(e,{...t,attributes:{...a,content:m()},setAttributes:p}):(0,i.createElement)(e,{...t})}),"personalizationTagsLiveContentUpdate");var D=a(942),O=a.n(D);const V=window.wp.blocks,H=window.wp.primitives;var G=a(848);const $=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M9 9v6h11V9H9zM4 20h1.5V4H4v16z"})}),U=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M12.5 15v5H11v-5H4V9h7V4h1.5v5h7v6h-7Z"})}),W=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M4 15h11V9H4v6zM18.5 4v16H20V4h-1.5z"})}),q="__experimentalEmailFlexLayout";function Z(e){return(0,V.hasBlockSupport)(e,q)}function Y({justificationValue:e,onChange:t,isToolbar:a=!1}){const n=[{value:"left",icon:$,label:(0,_.__)("Justify items left","mailpoet")},{value:"center",icon:U,label:(0,_.__)("Justify items center","mailpoet")},{value:"right",icon:W,label:(0,_.__)("Justify items right","mailpoet")}];if(a){const a=n.map((e=>e.value));return(0,i.createElement)(p.JustifyContentControl,{value:e,onChange:t,allowedControls:a,popoverProps:{placement:"bottom-start"}})}return(0,i.createElement)(f.__experimentalToggleGroupControl,{__nextHasNoMarginBottom:!0,label:(0,_.__)("Justification","mailpoet"),value:e,onChange:t,className:"block-editor-hooks__flex-layout-justification-controls"},n.map((({value:e,icon:t,label:a})=>(0,i.createElement)(f.__experimentalToggleGroupControlOptionIcon,{key:e,value:e,icon:t,label:a}))))}function J({setAttributes:e,attributes:t,name:a}){if(!(0,V.getBlockSupport)(a,q,{}))return null;const{justifyContent:n="left"}=t.layout||{},l=a=>{e({layout:{...t.layout,justifyContent:a}})};return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(p.InspectorControls,null,(0,i.createElement)(f.PanelBody,{title:(0,_.__)("Layout","mailpoet")},(0,i.createElement)(f.Flex,null,(0,i.createElement)(f.FlexItem,null,(0,i.createElement)(Y,{justificationValue:n,onChange:l}))))),(0,i.createElement)(p.BlockControls,{group:"block",__experimentalShareWithChildBlocks:!0},(0,i.createElement)(Y,{justificationValue:n,onChange:l,isToolbar:!0})))}function K(e){return Z(e.name)?{...e,attributes:{...e.attributes,layout:{type:"object"}}}:e}const X=(0,d.createHigherOrderComponent)((e=>t=>[Z(t.name)&&(0,i.createElement)(J,{key:"layout",...t}),(0,i.createElement)(e,{key:"edit",...t})]),"withLayoutControls");function Q({block:e,props:t}){const{attributes:a}=t,{layout:n}=a,l=`is-content-justification-${n?.justifyContent||"left"}`,o=O()(l,"is-layout-email-flex is-layout-flex");return(0,i.createElement)(e,{...t,className:o})}const ee=(0,d.createHigherOrderComponent)((e=>function(t){return Z(t.name)?(0,i.createElement)(Q,{block:e,props:t}):(0,i.createElement)(e,{...t})}),"withLayoutStyles"),te=window.wp.editor,ae=window.wp.coreData,ne=window.wp.privateApis,{unlock:le}=(0,ne.__dangerousOptInToUnstableAPIsOnlyForCoreModules)("I acknowledge private features are not for use in themes or plugins and doing so will break in the next version of WordPress.","@wordpress/edit-site"),{ExperimentalBlockCanvas:oe}=le(p.privateApis),{Tabs:ie}=le(f.privateApis),{ColorPanel:re}=le(p.privateApis),{useGlobalStylesOutputWithConfig:se}=le(p.privateApis),ce=window.wp.mediaUtils;function me(e){var t,a,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var l=e.length;for(t=0;t<l;t++)e[t]&&(a=me(e[t]))&&(n&&(n+=" "),n+=a)}else for(a in e)e[a]&&(n&&(n+=" "),n+=a);return n}const pe=function(){for(var e,t,a=0,n="",l=arguments.length;a<l;a++)(e=arguments[a])&&(t=me(e))&&(n&&(n+=" "),n+=t);return n},de=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),ue=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M11.776 4.454a.25.25 0 01.448 0l2.069 4.192a.25.25 0 00.188.137l4.626.672a.25.25 0 01.139.426l-3.348 3.263a.25.25 0 00-.072.222l.79 4.607a.25.25 0 01-.362.263l-4.138-2.175a.25.25 0 00-.232 0l-4.138 2.175a.25.25 0 01-.363-.263l.79-4.607a.25.25 0 00-.071-.222L4.754 9.881a.25.25 0 01.139-.426l4.626-.672a.25.25 0 00.188-.137l2.069-4.192z"})}),_e=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{fillRule:"evenodd",d:"M9.706 8.646a.25.25 0 01-.188.137l-4.626.672a.25.25 0 00-.139.427l3.348 3.262a.25.25 0 01.072.222l-.79 4.607a.25.25 0 00.362.264l4.138-2.176a.25.25 0 01.233 0l4.137 2.175a.25.25 0 00.363-.263l-.79-4.607a.25.25 0 01.072-.222l3.347-3.262a.25.25 0 00-.139-.427l-4.626-.672a.25.25 0 01-.188-.137l-2.069-4.192a.25.25 0 00-.448 0L9.706 8.646zM12 7.39l-.948 1.921a1.75 1.75 0 01-1.317.957l-2.12.308 1.534 1.495c.412.402.6.982.503 1.55l-.362 2.11 1.896-.997a1.75 1.75 0 011.629 0l1.895.997-.362-2.11a1.75 1.75 0 01.504-1.55l1.533-1.495-2.12-.308a1.75 1.75 0 01-1.317-.957L12 7.39z",clipRule:"evenodd"})}),ge=window.wp.viewport,he=window.wp.preferences,ye=window.wp.plugins,fe=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})}),Ee=window.wp.deprecated;var be=a.n(Ee);function ve(e){return["core/edit-post","core/edit-site"].includes(e)?(be()(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function we(e,t){return"core"===e&&"edit-site/template"===t?(be()("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(be()("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}const ke=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=ve(e),area:t=we(e,t)}),Se=(e,t)=>({registry:a,dispatch:n})=>{t&&(e=ve(e),t=we(e,t),a.select(he.store).get(e,"isComplementaryAreaVisible")||a.dispatch(he.store).set(e,"isComplementaryAreaVisible",!0),n({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},xe=e=>({registry:t})=>{e=ve(e),t.select(he.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(he.store).set(e,"isComplementaryAreaVisible",!1)},Ce=(e,t)=>({registry:a})=>{if(!t)return;e=ve(e),t=we(e,t);const n=a.select(he.store).get(e,"pinnedItems");!0!==n?.[t]&&a.dispatch(he.store).set(e,"pinnedItems",{...n,[t]:!0})},Te=(e,t)=>({registry:a})=>{if(!t)return;e=ve(e),t=we(e,t);const n=a.select(he.store).get(e,"pinnedItems");a.dispatch(he.store).set(e,"pinnedItems",{...n,[t]:!1})};function Ne(e,t){return function({registry:a}){be()("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),a.dispatch(he.store).toggle(e,t)}}function Pe(e,t,a){return function({registry:n}){be()("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),n.dispatch(he.store).set(e,t,!!a)}}function Ie(e,t){return function({registry:a}){be()("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),a.dispatch(he.store).setDefaults(e,t)}}function Me(e){return{type:"OPEN_MODAL",name:e}}function Be(){return{type:"CLOSE_MODAL"}}const Ae=(0,r.createRegistrySelector)((e=>(t,a)=>{a=ve(a);const n=e(he.store).get(a,"isComplementaryAreaVisible");if(void 0!==n)return!1===n?null:t?.complementaryAreas?.[a]})),Le=(0,r.createRegistrySelector)((e=>(t,a)=>{a=ve(a);const n=e(he.store).get(a,"isComplementaryAreaVisible"),l=t?.complementaryAreas?.[a];return n&&void 0===l})),Re=(0,r.createRegistrySelector)((e=>(t,a,n)=>{var l;n=we(a=ve(a),n);const o=e(he.store).get(a,"pinnedItems");return null===(l=o?.[n])||void 0===l||l})),ze=(0,r.createRegistrySelector)((e=>(t,a,n)=>(be()("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(he.store).get(a,n))));function Fe(e,t){return e.activeModal===t}const je=(0,r.combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:a,area:n}=t;return e[a]?e:{...e,[a]:n}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:a,area:n}=t;return{...e,[a]:n}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}}),De=(0,r.createReduxStore)("core/interface",{reducer:je,actions:e,selectors:t});function Oe({as:e=f.Button,scope:t,identifier:a,icon:n,selectedIcon:l,name:o,shortcut:i,...s}){const c=e,m=(0,ye.usePluginContext)(),p=n||m.icon,d=a||`${m.name}/${o}`,u=(0,r.useSelect)((e=>e(De).getActiveComplementaryArea(t)===d),[d,t]),{enableComplementaryArea:_,disableComplementaryArea:g}=(0,r.useDispatch)(De);return(0,G.jsx)(c,{icon:l&&u?l:p,"aria-controls":d.replace("/",":"),"aria-checked":(h=s.role,["checkbox","option","radio","switch","menuitemcheckbox","menuitemradio","treeitem"].includes(h)?u:void 0),onClick:()=>{u?g(t):_(t,d)},shortcut:i,...s});var h}(0,r.register)(De);const Ve=({children:e,className:t,toggleButtonProps:a})=>{const n=(0,G.jsx)(Oe,{icon:fe,...a});return(0,G.jsxs)("div",{className:pe("components-panel__header","interface-complementary-area-header",t),tabIndex:-1,children:[e,n]})},He=()=>{};function Ge({name:e,as:t=f.Button,onClick:a,...n}){return(0,G.jsx)(f.Fill,{name:e,children:({onClick:e})=>(0,G.jsx)(t,{onClick:a||e?(...t)=>{(a||He)(...t),(e||He)(...t)}:void 0,...n})})}Ge.Slot=function({name:e,as:t=f.ButtonGroup,fillProps:a={},bubblesVirtually:n,...l}){return(0,G.jsx)(f.Slot,{name:e,bubblesVirtually:n,fillProps:a,children:e=>{if(!s.Children.toArray(e).length)return null;const a=[];s.Children.forEach(e,(({props:{__unstableExplicitMenuItem:e,__unstableTarget:t}})=>{t&&e&&a.push(t)}));const n=s.Children.map(e,(e=>!e.props.__unstableExplicitMenuItem&&a.includes(e.props.__unstableTarget)?null:e));return(0,G.jsx)(t,{...l,children:n})}})};const $e=Ge,Ue=({__unstableExplicitMenuItem:e,__unstableTarget:t,...a})=>(0,G.jsx)(f.MenuItem,{...a});function We({scope:e,target:t,__unstableExplicitMenuItem:a,...n}){return(0,G.jsx)(Oe,{as:n=>(0,G.jsx)($e,{__unstableExplicitMenuItem:a,__unstableTarget:`${e}/${t}`,as:Ue,name:`${e}/plugin-more-menu`,...n}),role:"menuitemcheckbox",selectedIcon:de,name:t,scope:e,...n})}function qe({scope:e,...t}){return(0,G.jsx)(f.Fill,{name:`PinnedItems/${e}`,...t})}qe.Slot=function({scope:e,className:t,...a}){return(0,G.jsx)(f.Slot,{name:`PinnedItems/${e}`,...a,children:e=>e?.length>0&&(0,G.jsx)("div",{className:pe(t,"interface-pinned-items"),children:e})})};const Ze=qe,Ye={open:{width:280},closed:{width:0},mobileOpen:{width:"100vw"}};function Je({activeArea:e,isActive:t,scope:a,children:n,className:l,id:o}){const i=(0,d.useReducedMotion)(),r=(0,d.useViewportMatch)("medium","<"),c=(0,d.usePrevious)(e),m=(0,d.usePrevious)(t),[,p]=(0,s.useState)({});(0,s.useEffect)((()=>{p({})}),[t]);const u={type:"tween",duration:i||r||c&&e&&e!==c?0:.3,ease:[.6,0,.4,1]};return(0,G.jsx)(f.Fill,{name:`ComplementaryArea/${a}`,children:(0,G.jsx)(f.__unstableAnimatePresence,{initial:!1,children:(m||t)&&(0,G.jsx)(f.__unstableMotion.div,{variants:Ye,initial:"closed",animate:r?"mobileOpen":"open",exit:"closed",transition:u,className:"interface-complementary-area__fill",children:(0,G.jsx)("div",{id:o,className:l,style:{width:r?"100vw":280},children:n})})})})}function Ke({children:e,className:t,closeLabel:a=(0,_.__)("Close plugin"),identifier:n,header:l,headerClassName:o,icon:i,isPinnable:c=!0,panelClassName:m,scope:p,name:u,title:g,toggleShortcut:h,isActiveByDefault:y}){const E=(0,ye.usePluginContext)(),b=i||E.icon,v=n||`${E.name}/${u}`,[w,k]=(0,s.useState)(!1),{isLoading:S,isActive:x,isPinned:C,activeArea:T,isSmall:N,isLarge:P,showIconLabels:I}=(0,r.useSelect)((e=>{const{getActiveComplementaryArea:t,isComplementaryAreaLoading:a,isItemPinned:n}=e(De),{get:l}=e(he.store),o=t(p);return{isLoading:a(p),isActive:o===v,isPinned:n(p,v),activeArea:o,isSmall:e(ge.store).isViewportMatch("< medium"),isLarge:e(ge.store).isViewportMatch("large"),showIconLabels:l("core","showIconLabels")}}),[v,p]),M=(0,d.useViewportMatch)("medium","<");!function(e,t,a,n,l){const o=(0,s.useRef)(!1),i=(0,s.useRef)(!1),{enableComplementaryArea:c,disableComplementaryArea:m}=(0,r.useDispatch)(De);(0,s.useEffect)((()=>{n&&l&&!o.current?(m(e),i.current=!0):i.current&&!l&&o.current?(i.current=!1,c(e,t)):i.current&&a&&a!==t&&(i.current=!1),l!==o.current&&(o.current=l)}),[n,l,e,t,a,m,c])}(p,v,T,x,N);const{enableComplementaryArea:B,disableComplementaryArea:A,pinItem:L,unpinItem:R}=(0,r.useDispatch)(De);if((0,s.useEffect)((()=>{y&&void 0===T&&!N?B(p,v):void 0===T&&N&&A(p,v),k(!0)}),[T,y,p,v,N,B,A]),w)return(0,G.jsxs)(G.Fragment,{children:[c&&(0,G.jsx)(Ze,{scope:p,children:C&&(0,G.jsx)(Oe,{scope:p,identifier:v,isPressed:x&&(!I||P),"aria-expanded":x,"aria-disabled":S,label:g,icon:I?de:b,showTooltip:!I,variant:I?"tertiary":void 0,size:"compact",shortcut:h})}),u&&c&&(0,G.jsx)(We,{target:u,scope:p,icon:b,children:g}),(0,G.jsxs)(Je,{activeArea:T,isActive:x,className:pe("interface-complementary-area",t),scope:p,id:v.replace("/",":"),children:[(0,G.jsx)(Ve,{className:o,closeLabel:a,onClose:()=>A(p),toggleButtonProps:{label:a,size:"compact",shortcut:h,scope:p,identifier:v},children:l||(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("h2",{className:"interface-complementary-area-header__title",children:g}),c&&!M&&(0,G.jsx)(f.Button,{className:"interface-complementary-area__pin-unpin-item",icon:C?ue:_e,label:C?(0,_.__)("Unpin from toolbar"):(0,_.__)("Pin to toolbar"),onClick:()=>(C?R:L)(p,v),isPressed:C,"aria-expanded":C,size:"compact"})]})}),(0,G.jsx)(f.Panel,{className:m,children:e})]})]})}Ke.Slot=function({scope:e,...t}){return(0,G.jsx)(f.Slot,{name:`ComplementaryArea/${e}`,...t})};const Xe=Ke,Qe=({isActive:e})=>((0,s.useEffect)((()=>{let e=!1;return document.body.classList.contains("sticky-menu")&&(e=!0,document.body.classList.remove("sticky-menu")),()=>{e&&document.body.classList.add("sticky-menu")}}),[]),(0,s.useEffect)((()=>(e?document.body.classList.add("is-fullscreen-mode"):document.body.classList.remove("is-fullscreen-mode"),()=>{e&&document.body.classList.remove("is-fullscreen-mode")})),[e]),null),et=(0,s.forwardRef)((({children:e,className:t,ariaLabel:a,as:n="div",...l},o)=>(0,G.jsx)(n,{ref:o,className:pe("interface-navigable-region",t),"aria-label":a,role:"region",tabIndex:"-1",...l,children:e})));et.displayName="NavigableRegion";const tt=et,at={type:"tween",duration:.25,ease:[.6,0,.4,1]},nt={hidden:{opacity:1,marginTop:-60},visible:{opacity:1,marginTop:0},distractionFreeHover:{opacity:1,marginTop:0,transition:{...at,delay:.2,delayChildren:.2}},distractionFreeHidden:{opacity:0,marginTop:-60},distractionFreeDisabled:{opacity:0,marginTop:0,transition:{...at,delay:.8,delayChildren:.8}}},lt=(0,s.forwardRef)((function({isDistractionFree:e,footer:t,header:a,editorNotices:n,sidebar:l,secondarySidebar:o,content:i,actions:r,labels:c,className:m},p){const[u,g]=(0,d.useResizeObserver)(),h=(0,d.useViewportMatch)("medium","<"),y={type:"tween",duration:(0,d.useReducedMotion)()?0:.25,ease:[.6,0,.4,1]};!function(e){(0,s.useEffect)((()=>{const t=document&&document.querySelector(`html:not(.${e})`);if(t)return t.classList.toggle(e),()=>{t.classList.toggle(e)}}),[e])}("interface-interface-skeleton__html-container");const E={
/* translators: accessibility text for the top bar landmark region. */
header:(0,_._x)("Header","header landmark area"),
/* translators: accessibility text for the content landmark region. */
body:(0,_.__)("Content"),
/* translators: accessibility text for the secondary sidebar landmark region. */
secondarySidebar:(0,_.__)("Block Library"),
/* translators: accessibility text for the settings landmark region. */
sidebar:(0,_._x)("Settings","settings landmark area"),
/* translators: accessibility text for the publish landmark region. */
actions:(0,_.__)("Publish"),
/* translators: accessibility text for the footer landmark region. */
footer:(0,_.__)("Footer"),...c};return(0,G.jsxs)("div",{ref:p,className:pe(m,"interface-interface-skeleton",!!t&&"has-footer"),children:[(0,G.jsxs)("div",{className:"interface-interface-skeleton__editor",children:[(0,G.jsx)(f.__unstableAnimatePresence,{initial:!1,children:!!a&&(0,G.jsx)(tt,{as:f.__unstableMotion.div,className:"interface-interface-skeleton__header","aria-label":E.header,initial:e&&!h?"distractionFreeHidden":"hidden",whileHover:e&&!h?"distractionFreeHover":"visible",animate:e&&!h?"distractionFreeDisabled":"visible",exit:e&&!h?"distractionFreeHidden":"hidden",variants:nt,transition:y,children:a})}),e&&(0,G.jsx)("div",{className:"interface-interface-skeleton__header",children:n}),(0,G.jsxs)("div",{className:"interface-interface-skeleton__body",children:[(0,G.jsx)(f.__unstableAnimatePresence,{initial:!1,children:!!o&&(0,G.jsx)(tt,{className:"interface-interface-skeleton__secondary-sidebar",ariaLabel:E.secondarySidebar,as:f.__unstableMotion.div,initial:"closed",animate:"open",exit:"closed",variants:{open:{width:g.width},closed:{width:0}},transition:y,children:(0,G.jsxs)(f.__unstableMotion.div,{style:{position:"absolute",width:h?"100vw":"fit-content",height:"100%",left:0},variants:{open:{x:0},closed:{x:"-100%"}},transition:y,children:[u,o]})})}),(0,G.jsx)(tt,{className:"interface-interface-skeleton__content",ariaLabel:E.body,children:i}),!!l&&(0,G.jsx)(tt,{className:"interface-interface-skeleton__sidebar",ariaLabel:E.sidebar,children:l}),!!r&&(0,G.jsx)(tt,{className:"interface-interface-skeleton__actions",ariaLabel:E.actions,children:r})]})]}),!!t&&(0,G.jsx)(tt,{className:"interface-interface-skeleton__footer",ariaLabel:E.footer,children:t})]})}));var ot=a(744),it=a.n(ot);function rt(){const{globalStylePost:e}=(0,r.useSelect)((e=>({globalStylePost:e(v).getGlobalEmailStylesPost()})),[]),t=(0,s.useCallback)((t=>{e&&(0,r.dispatch)(ae.store).editEntityRecord("postType","wp_global_styles",e.id,{styles:t.styles,settings:t.settings})}),[e]);return{userTheme:{settings:e?.settings,styles:e?.styles},updateUserTheme:t}}function st(){const{userTheme:e}=rt(),{editorTheme:t}=(0,r.useSelect)((e=>({editorTheme:e(v).getTheme()})),[]),a=(0,s.useMemo)((()=>it().all([{},t||{},e||{}])),[t,e]),[n]=se(a);return[n||[]]}function ct(){const{hasEdits:e,autosaveInterval:t}=(0,r.useSelect)((e=>({hasEdits:e(v).hasEdits(),autosaveInterval:e(v).getAutosaveInterval()})),[]),{saveEditedEmail:a}=(0,r.useDispatch)(v);return(0,s.useEffect)((()=>{let n;return e&&t>0&&(n=setTimeout((()=>{a(),M("editor_content_auto_saved")}),1e3*t)),()=>{n&&clearTimeout(n)}}),[e,t,a]),null}const mt=(0,G.jsx)(H.SVG,{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-4 14.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h8v13zm4.5-.5c0 .3-.2.5-.5.5h-2.5v-13H18c.3 0 .5.2.5.5v12z"})});function pt(){const{isEditingTemplate:e}=(0,r.useSelect)((e=>({isEditingTemplate:"wp_template"===e(te.store).getCurrentPostType()})),[]);return[e?"template":"email"]}const dt=s.forwardRef((function(e,t){const[a]=pt();return(0,i.createElement)(ie.TabList,{ref:t},(0,i.createElement)(ie.Tab,{tabId:w},"template"===a?(0,_.__)("Template","mailpoet"):(0,_.__)("Email","mailpoet")),(0,i.createElement)(ie.Tab,{tabId:k},(0,_.__)("Block")))}));function ut({label:e,labelSuffix:t,help:a,placeholder:n,attributeName:l}){var o;const[c]=(0,ae.useEntityProp)("postType","mailpoet_email","mailpoet_data"),{updateEmailMailPoetProperty:m}=(0,r.useDispatch)(v),[d,u]=(0,s.useState)(null),[g,h]=(0,s.useState)(!1),w=(0,r.useSelect)((e=>e(v).getPersonalizationTagsList()),[]),k=(0,s.useRef)(null),S=(0,s.useCallback)(((e,t,a)=>{var n,o;const i=null!==(n=a?.start)&&void 0!==n?n:t.length,r=null!==(o=a?.end)&&void 0!==o?o:t.length;let s=(0,y.create)({html:t});s=(0,y.insert)(s,(0,y.create)({html:`\x3c!--${e}--\x3e`}),i,r);const c=(0,y.toHTMLString)({value:s});m(l,c),u(null)}),[l,m]),x=(0,i.createElement)(i.Fragment,null,(0,i.createElement)("span",null,e),(0,i.createElement)(f.Button,{className:"mailpoet-settings-panel__personalization-tags-button",icon:"shortcode",title:(0,_.__)("Personalization Tags","mailpoet"),onClick:()=>{h(!0),M("rich_text_with_button_personalization_tags_shortcode_icon_clicked",{attributeName:l,label:e})}}),t);return c?(0,i.createElement)(f.BaseControl,{id:`mailpoet-settings-panel__${l}`,label:x,className:`mailpoet-settings-panel__${l}-text`,help:a,__nextHasNoMarginBottom:!0},(0,i.createElement)(L,{isOpened:g,onInsert:e=>{var t;S(e,null!==(t=c[l])&&void 0!==t?t:"",d),h(!1),M("rich_text_with_button_personalization_tags_inserted",{attributeName:l,value:e})},closeCallback:()=>h(!1),openedBy:"RichTextWithButton-BaseControl"}),(0,i.createElement)(R,{contentRef:k,onUpdate:(e,t)=>{var a;const n=(null!==(a=c[l])&&void 0!==a?a:"").replace(`\x3c!--[${e}]--\x3e`,`\x3c!--[${t}]--\x3e`);m(l,n)}}),(0,i.createElement)(p.RichText,{ref:k,className:"mailpoet-settings-panel__richtext",placeholder:n,onFocus:()=>{var e;u(E(k,null!==(e=c[l])&&void 0!==e?e:""))},onKeyUp:()=>{var e;u(E(k,null!==(e=c[l])&&void 0!==e?e:""))},onClick:()=>{var e;u(E(k,null!==(e=c[l])&&void 0!==e?e:""))},onChange:e=>{var t;e=b(null!==(t=e)&&void 0!==t?t:"",w),m(l,e),B("rich_text_with_button_input_field_updated",{attributeName:l})},value:null!==(o=c[l])&&void 0!==o?o:"","data-automation-id":`email_${l}`})):null}function _t(){var e;const[t]=(0,ae.useEntityProp)("postType","mailpoet_email","mailpoet_data"),a=(0,s.createInterpolateElement)((0,_.__)("Use personalization tags to personalize your email, or learn more about <bestPracticeLink>best practices</bestPracticeLink> and using <emojiLink>emoji in subject lines</emojiLink>.","mailpoet"),{bestPracticeLink:(0,i.createElement)("a",{href:"https://www.mailpoet.com/blog/17-email-subject-line-best-practices-to-boost-engagement/",target:"_blank",rel:"noopener noreferrer",onClick:()=>M("details_panel_subject_help_best_practice_link_clicked")}),emojiLink:(0,i.createElement)("a",{href:"https://www.mailpoet.com/blog/tips-using-emojis-in-subject-lines/",target:"_blank",rel:"noopener noreferrer",onClick:()=>M("details_panel_subject_help_emoji_in_subject_lines_link_clicked")})}),n=null!==(e=t?.preheader?.length)&&void 0!==e?e:0,l=(0,s.createInterpolateElement)((0,_.__)("<link>This text</link> will appear in the inbox, underneath the subject line.","mailpoet"),{link:(0,i.createElement)("a",{href:new URL("article/418-preview-text","https://kb.mailpoet.com/").toString(),key:"preview-text-kb",target:"_blank",rel:"noopener noreferrer",onClick:()=>M("details_panel_preheader_help_text_link_clicked")})});return(0,i.createElement)(f.PanelBody,{title:(0,_.__)("Details","mailpoet"),className:"mailpoet-email-editor__settings-panel",onToggle:e=>M("details_panel_body_toggle",{opened:e})},(0,i.createElement)(ut,{attributeName:"subject",label:(0,_.__)("Subject","mailpoet"),labelSuffix:(0,i.createElement)(f.ExternalLink,{href:"https://kb.mailpoet.com/article/435-a-guide-to-personalisation-tags-for-tailored-newsletters#list",onClick:()=>M("details_panel_personalisation_tags_guide_link_clicked")},(0,_.__)("Guide","mailpoet")),help:a,placeholder:(0,_.__)("Eg. The summer sale is here!","mailpoet")}),(0,i.createElement)(ut,{attributeName:"preheader",label:(0,_.__)("Preview text","mailpoet"),labelSuffix:(0,i.createElement)("span",{className:O()("mailpoet-settings-panel__preview-text-length",{"mailpoet-settings-panel__preview-text-length-warning":n>80,"mailpoet-settings-panel__preview-text-length-error":n>150})},n,"/",150),help:l,placeholder:(0,_.__)("Add a preview text to capture subscribers' attention and increase open rates.","mailpoet")}))}const gt=(0,s.forwardRef)((function({icon:e,size:t=24,...a},n){return(0,s.cloneElement)(e,{width:t,height:t,...a,ref:n})})),ht=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{fillRule:"evenodd",d:"M6.863 13.644L5 13.25h-.5a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5H5L18 6.5h2V16h-2l-3.854-.815.026.008a3.75 3.75 0 01-7.31-1.549zm1.477.313a2.251 2.251 0 004.356.921l-4.356-.921zm-2.84-3.28L18.157 8h.343v6.5h-.343L5.5 11.823v-1.146z",clipRule:"evenodd"})});function yt({close:e}){B("edit_template_modal_opened");const{onNavigateToEntityRecord:t,template:a}=(0,r.useSelect)((e=>{const{getEditorSettings:t}=e(te.store);return{onNavigateToEntityRecord:t().onNavigateToEntityRecord,template:e(v).getCurrentTemplate()}}),[]);return(0,i.createElement)(f.Modal,{size:"medium",onRequestClose:e,__experimentalHideHeader:!0},(0,i.createElement)("p",null,(0,_.__)("Note that the same template can be used by multiple emails, so any changes made here may affect other emails on the site. To switch back to editing the page content click the ‘Back’ button in the toolbar.","mailpoet")),(0,i.createElement)(f.Flex,{justify:"end"},(0,i.createElement)(f.FlexItem,null,(0,i.createElement)(f.Button,{variant:"tertiary",onClick:()=>{M("edit_template_modal_cancel_button_clicked"),e()}},(0,_.__)("Cancel","mailpoet"))),(0,i.createElement)(f.FlexItem,null,(0,i.createElement)(f.Button,{variant:"primary",onClick:()=>{M("edit_template_modal_continue_button_clicked",{templateId:a.id}),t({postId:a.id,postType:"wp_template"})},disabled:!a.id},(0,_.__)("Continue","mailpoet")))))}function ft(e,t){return e.map((e=>"core/post-content"===e.name?{...e,name:"core/group",innerBlocks:t}:e.innerBlocks?.length?{...e,innerBlocks:ft(e.innerBlocks,t)}:e))}const Et={};const bt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M19 8h-1V6h-5v2h-2V6H6v2H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm.5 10c0 .3-.2.5-.5.5H5c-.3 0-.5-.2-.5-.5v-8c0-.3.2-.5.5-.5h14c.3 0 .5.2.5.5v8z"})}),vt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})}),wt=(0,window.wp.priorityQueue.createQueue)();function kt({children:e,placeholder:t}){const[a,n]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{const e={};return wt.add(e,(()=>{(0,s.flushSync)((()=>{n(!0)}))})),()=>{wt.cancel(e)}}),[]),a?e:t}function St(){return(0,i.createElement)("div",{className:"block-editor-inserter__no-results"},(0,i.createElement)(gt,{className:"block-editor-inserter__no-results-icon",icon:bt}),(0,i.createElement)("p",null,(0,_.__)("No recent templates.")),(0,i.createElement)("p",null,(0,_.__)("Your recent creations will appear here as soon as you begin.")))}const xt=(0,s.memo)((function({templates:e,onTemplateSelection:t,selectedCategory:a}){const{layout:n}=(0,r.useSelect)((e=>{const{getEditorSettings:t}=e(te.store);return{layout:t().__experimentalFeatures.layout}})),[l]=st(),o=l.reduce(((e,t)=>{var a;return e+(null!==(a=t.css)&&void 0!==a?a:"")}),"")+`.is-root-container { width: ${n.contentSize}; margin: 0 auto; }`;return"recent"===a&&0===e.length?(0,i.createElement)(St,null):(0,i.createElement)("div",{className:"block-editor-block-patterns-list",role:"listbox"},e.map((e=>(0,i.createElement)("div",{key:`${e.slug}_${e.displayName}_${e.id}`,className:"block-editor-block-patterns-list__list-item email-editor-pattern__list-item"},(0,i.createElement)("div",{className:"block-editor-block-patterns-list__item",role:"button",tabIndex:0,onClick:()=>{t(e)},onKeyPress:a=>{"Enter"!==a.key&&" "!==a.key||t(e)}},(0,i.createElement)(kt,{placeholder:(0,i.createElement)("p",null,(0,_.__)("rendering template","mailpoet"))},(0,i.createElement)(p.BlockPreview,{blocks:e.previewContentParsed,viewportWidth:900,minHeight:300,additionalStyles:[{css:o}]}),(0,i.createElement)(f.__experimentalHStack,{className:"block-editor-patterns__pattern-details"},(0,i.createElement)("h4",{className:"block-editor-block-patterns-list__item-title"},e.displayName))))))))}),((e,t)=>e.templates.length===t.templates.length&&e.selectedCategory===t.selectedCategory));function Ct({templates:e,onTemplateSelection:t,selectedCategory:a}){const n=(0,s.useMemo)((()=>e.filter((e=>e.category===a))),[a,e]);return(0,i.createElement)("div",{className:"block-editor-block-patterns-explorer__list"},"recent"===a&&(0,i.createElement)("div",{className:"email-editor-recent-templates-info"},(0,i.createElement)(f.__experimentalHStack,{spacing:1,expanded:!1,justify:"start"},(0,i.createElement)(gt,{icon:vt}),(0,i.createElement)("p",null,(0,_.__)("Templates created on the legacy editor will not appear here.","mailpoet")))),(0,i.createElement)(xt,{templates:n,onTemplateSelection:t,selectedCategory:a}))}function Tt({selectedCategory:e,templateCategories:t,onClickCategory:a}){const n="block-editor-block-patterns-explorer__sidebar";return(0,i.createElement)("div",{className:n},(0,i.createElement)("div",{className:`${n}__categories-list`},t.map((({name:t,label:l})=>(0,i.createElement)(f.Button,{key:t,label:l,className:`${n}__categories-list__item`,isPressed:e===t,onClick:()=>{a(t)}},l)))))}const Nt=[{name:"recent",label:"Recent"},{name:"basic",label:"Basic"}],Pt=(0,s.memo)((function({hasEmailPosts:e,templates:t,handleTemplateSelection:a}){const[n,l]=(0,s.useState)(Nt[1].name);return(0,s.useEffect)((()=>{setTimeout((()=>{e&&l(Nt[0].name)}),1e3)}),[e]),(0,i.createElement)("div",{className:"block-editor-block-patterns-explorer"},(0,i.createElement)(Tt,{templateCategories:Nt,selectedCategory:n,onClickCategory:e=>{M("template_select_modal_category_change",{category:e}),l(e)}}),(0,i.createElement)(Ct,{templates:t,onTemplateSelection:a,selectedCategory:n}))}));function It({onSelectCallback:e,closeCallback:t=null,previewContent:a=""}){const n=a?"swap":"new";B("template_select_modal_opened",{templateSelectMode:n});const[l,o,c]=function(e=""){const{templates:t,patterns:a,emailPosts:n,hasEmailPosts:l}=(0,r.useSelect)((e=>{const t=e(p.store).getBlocksByName("core/post-content")?.[0],a=e(v).getSentEmailEditorPosts();return{templates:e(v).getEmailTemplates(),patterns:e(p.store).getPatternsByBlockTypes(["core/post-content"],t),emailPosts:a,hasEmailPosts:!(!a||!a?.length)}}),[]),o=(0,s.useMemo)((()=>{let n=[];const l=e&&(0,V.parse)(e);if(n=l?[{blocks:l}]:a.filter((e=>e?.templateTypes?.includes("email-template"))),!n||!t)return[];const o=[];return t?.filter((e=>"email-general"!==e.slug))?.forEach((e=>{n?.forEach((t=>{let a=(0,V.parse)(e.content?.raw);a=ft(a,t.blocks),o.push({id:e.id,slug:e.slug,previewContentParsed:a,emailParsed:t.blocks,template:e,category:"basic",type:e.type,displayName:t.title?`${e.title.rendered} - ${t.title}`:e.title.rendered})}))})),o}),[t,a,e]),i=(0,s.useMemo)((()=>n?.map((e=>{const{postTemplateContent:t}=function(e,t=[]){const a=e.template,n={postTemplateContent:null};if(!a)return n;if(Et[a])return Et[a];const l=t.find((e=>e.slug===a));if(!l)return n;const o={postTemplateContent:l?.template};return Et[a]=o,o}(e,o),a=(0,V.parse)(e.content?.raw);let n=a;t?.content?.raw&&(n=ft((0,V.parse)(t?.content?.raw),a));const l={...e,title:{raw:e?.mailpoet_data?.subject||e.title.raw,rendered:e?.mailpoet_data?.subject||e.title.rendered}};return{id:e.id,slug:e.slug,previewContentParsed:n,emailParsed:a,category:"recent",type:e.type,displayName:l.title.rendered,template:l}}))),[n,o]);return[o||[],i||[],l]}(a),m=l?.length>0,d=t=>{const l="mailpoet_email"===t.type,o=t.template;M("template_select_modal_template_selected",{templateSlug:t.slug,templateSelectMode:n,templateType:t.type}),a||(0,r.dispatch)(te.store).resetEditorBlocks(t.emailParsed),(0,r.dispatch)(v).setTemplateToPost(l?o.template:t.slug),e()},u=()=>{var e;const t=null!==(e=l[0])&&void 0!==e?e:null;t&&(M("template_select_modal_handle_close_without_template_selected"),d(t))};return(0,i.createElement)(f.Modal,{title:(0,_.__)("Start with an email preset","mailpoet"),onRequestClose:()=>(M("template_select_modal_closed",{templateSelectMode:n}),t?t():u()),isFullScreen:!0},(0,i.createElement)(Pt,{hasEmailPosts:c,templates:[...l,...o],handleTemplateSelection:d}),(0,i.createElement)(f.Flex,{className:"email-editor-modal-footer",justify:"flex-end"},(0,i.createElement)(f.FlexItem,null,(0,i.createElement)(f.Button,{variant:"tertiary",className:"email-editor-start_from_scratch_button",onClick:()=>(M("template_select_modal_start_from_scratch_clicked"),u()),isBusy:!m},(0,_.__)("Start from scratch","mailpoet")))))}function Mt(){const{template:e,currentEmailContent:t}=(0,r.useSelect)((e=>({template:e(v).getCurrentTemplate(),currentEmailContent:e(v).getEditedEmailContent()})),[]),[a,n]=(0,s.useState)(!1),[l,o]=(0,s.useState)(!1);return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.Panel,{className:"mailpoet-email-sidebar__email-type-info"},(0,i.createElement)(f.PanelBody,null,(0,i.createElement)(f.PanelRow,null,(0,i.createElement)("span",{className:"mailpoet-email-type-info__icon"},(0,i.createElement)(gt,{icon:ht})),(0,i.createElement)("div",{className:"mailpoet-email-type-info__content"},(0,i.createElement)("h2",null,(0,_.__)("Newsletter","mailpoet")),(0,i.createElement)("span",null,(0,_.__)("Send or schedule a newsletter to connect with your subscribers.","mailpoet")))),e&&(0,i.createElement)(f.PanelRow,null,(0,i.createElement)(f.Flex,{justify:"start"},(0,i.createElement)(f.FlexItem,{className:"editor-post-panel__row-label"},(0,_.__)("Template","mailpoet")),(0,i.createElement)(f.FlexItem,null,(0,i.createElement)(f.DropdownMenu,{icon:null,text:e?.title,toggleProps:{variant:"tertiary"},label:(0,_.__)("Template actions","mailpoet"),onToggle:t=>M("sidebar_template_actions_clicked",{currentTemplate:e?.title,isOpen:t})},(({onClose:e})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.MenuItem,{onClick:()=>{M("sidebar_template_actions_edit_template_clicked"),n(!0),e()}},(0,_.__)("Edit template","mailpoet")),(0,i.createElement)(f.MenuItem,{onClick:()=>{M("sidebar_template_actions_swap_template_clicked"),o(!0),e()}},(0,_.__)("Swap template","mailpoet")))))))))),a&&(0,i.createElement)(yt,{close:()=>(M("edit_template_modal_closed"),n(!1))}),l&&(0,i.createElement)(It,{onSelectCallback:()=>o(!1),closeCallback:()=>o(!1),previewContent:t}))}function Bt(){return(0,i.createElement)(f.Panel,null,(0,i.createElement)(Mt,null),(0,i.createElement)(_t,null))}const At=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M18 5.5H6a.5.5 0 00-.5.5v3h13V6a.5.5 0 00-.5-.5zm.5 5H10v8h8a.5.5 0 00.5-.5v-7.5zm-10 0h-3V18a.5.5 0 00.5.5h2.5v-8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})}),Lt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})});function Rt({close:e}){const t=(0,r.useSelect)((e=>e(v).getCurrentTemplate()),[]),{revertAndSaveTemplate:a}=(0,r.useDispatch)(v);return(0,i.createElement)(f.Modal,{size:"medium",onRequestClose:e,__experimentalHideHeader:!0},(0,i.createElement)("p",null,(0,_.__)("This will clear ANY and ALL template customization. All updates made to the template will be lost. Do you want to proceed?","mailpoet")),(0,i.createElement)(f.Flex,{justify:"end"},(0,i.createElement)(f.FlexItem,null,(0,i.createElement)(f.Button,{variant:"tertiary",onClick:e},(0,_.__)("Cancel","mailpoet"))),(0,i.createElement)(f.FlexItem,null,(0,i.createElement)(f.Button,{variant:"primary",onClick:async()=>{await a(t),e()}},(0,_.__)("Reset","mailpoet")))))}function zt(){const e=(0,r.useSelect)((e=>e(v).getCurrentTemplate()),[]),[t,a]=(0,s.useState)(!1),n=e?.description||"";return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.Panel,{className:"mailpoet-email-sidebar__email-type-info"},(0,i.createElement)(f.PanelBody,null,(0,i.createElement)(f.PanelRow,null,(0,i.createElement)("span",{className:"mailpoet-email-type-info__icon"},(0,i.createElement)(gt,{icon:At})),(0,i.createElement)("div",{className:"mailpoet-email-type-info__content"},(0,i.createElement)("div",{className:"mailpoet-email-type-info__content_heading"},(0,i.createElement)("h2",null,e?.title||(0,_.__)("Template","mailpoet")),(0,i.createElement)(f.DropdownMenu,{icon:Lt,label:(0,_.__)("Template actions","mailpoet")},(({onClose:e})=>(0,i.createElement)(f.MenuItem,{onClick:()=>{a(!0),e()},info:(0,_.__)("Reset to default to clear all customizations","mailpoet")},(0,_.__)("Reset","mailpoet"))))),n&&(0,i.createElement)("p",null,n||""),(0,i.createElement)("p",null,(0,_.__)("Edit this template to be used across multiple emails.","mailpoet")))))),t&&(0,i.createElement)(Rt,{close:()=>{a(!1)}}))}function Ft(){return(0,i.createElement)(f.Panel,null,(0,i.createElement)(zt,null))}function jt(e){const[t]=pt(),a=(0,s.useRef)(null),n=(0,s.useContext)(ie.Context);return(0,i.createElement)(Xe,{identifier:"email-editor/editor/main",closeLabel:(0,_.__)("Close sidebar","mailpoet"),headerClassName:"editor-sidebar__panel-tabs",className:"edit-post-sidebar",header:(0,i.createElement)(ie.Context.Provider,{value:n},(0,i.createElement)(dt,{ref:a})),icon:mt,scope:v,smallScreenTitle:(0,_.__)("No title","mailpoet"),isActiveByDefault:!0,...e},(0,i.createElement)(ie.Context.Provider,{value:n},(0,i.createElement)(ie.TabPanel,{tabId:w},"template"===t?(0,i.createElement)(Ft,null):(0,i.createElement)(Bt,null)),(0,i.createElement)(ie.TabPanel,{tabId:k},(0,i.createElement)(p.BlockInspector,null))))}const Dt=(0,s.memo)((function(e){const{toggleSettingsSidebarActiveTab:t}=(0,r.useDispatch)(v),{activeTab:a,selectedBlockId:n}=(0,r.useSelect)((e=>({activeTab:e(v).getSettingsSidebarActiveTab(),selectedBlockId:e(p.store).getSelectedBlockClientId()})),[]);return(0,s.useEffect)((()=>{t(n?k:w)}),[n,t]),(0,i.createElement)(ie,{selectedTabId:a||w,onSelect:e=>(M("sidebar_tab_selected",{tabKey:e}),t(e))},(0,i.createElement)(jt,{...e}))}));function Ot(){const e=(0,r.useSelect)((e=>e("core/block-editor").getSelectedBlock()),[]),t=(0,V.hasBlockSupport)(e?.name,"border",!1)||(0,V.hasBlockSupport)(e?.name,"__experimentalBorder",!1);return(0,i.createElement)(i.Fragment,null,t&&(0,i.createElement)(f.Fill,{name:"InspectorControlsBorder"},(0,i.createElement)(f.Notice,{className:"mailpoet__grid-full-width",status:"warning",isDismissible:!1},(0,_.__)("Border display may vary or be unsupported in some email clients.","mailpoet"))),(e=>{const t=(0,V.getBlockSupport)(e,"background");return t&&!1!==t?.backgroundImage})(e?.name)&&(0,i.createElement)(f.Fill,{name:"InspectorControlsBackground"},(0,i.createElement)(f.Notice,{className:"mailpoet__grid-full-width",status:"warning",isDismissible:!1},(0,_.__)("Select a background color for email clients that do not support background images.","mailpoet"))))}const Vt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),Ht=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M18.3 11.7c-.6-.6-1.4-.9-2.3-.9H6.7l2.9-3.3-1.1-1-4.5 5L8.5 16l1-1-2.7-2.7H16c.5 0 .9.2 1.3.5 1 1 1 3.4 1 4.5v.3h1.5v-.2c0-1.5 0-4.3-1.5-5.7z"})}),Gt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M15.6 6.5l-1.1 1 2.9 3.3H8c-.9 0-1.7.3-2.3.9-1.4 1.5-1.4 4.2-1.4 5.6v.2h1.5v-.3c0-1.1 0-3.5 1-4.5.3-.3.7-.5 1.3-.5h9.2L14.5 15l1.1 1.1 4.6-4.6-4.6-5z"})}),$t=(0,G.jsx)(H.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,G.jsx)(H.Path,{d:"M3 6h11v1.5H3V6Zm3.5 5.5h11V13h-11v-1.5ZM21 17H10v1.5h11V17Z"})}),Ut=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),Wt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})}),qt=window.wp.keycodes,Zt=window.wp.notices;function Yt({onClose:e,onRemove:t,postId:a}){const{getLastEntityDeleteError:n}=(0,r.useSelect)(ae.store),{deleteEntityRecord:l}=(0,r.useDispatch)(ae.store),{createErrorNotice:o}=(0,r.useDispatch)(Zt.store),s=()=>{e()};return(0,i.createElement)(f.Modal,{className:"mailpoet-move-to-trash-modal",title:(0,_.__)("Move to trash","mailpoet"),onRequestClose:()=>{s(),M("trash_modal_closed")},focusOnMount:!0},(0,i.createElement)("p",null,(0,_.__)("Are you sure you want to move this email to trash?","mailpoet")),(0,i.createElement)("div",{className:"mailpoet-send-preview-modal-footer"},(0,i.createElement)(f.Button,{variant:"tertiary",onClick:()=>{s(),M("trash_modal_cancel_button_clicked")}},(0,_.__)("Cancel","mailpoet")),(0,i.createElement)(f.Button,{variant:"primary",onClick:async()=>{if(M("trash_modal_move_to_trash_button_clicked"),await l("postType","mailpoet_email",a,{},{throwOnError:!1}))t();else{const e=n("postType","mailpoet_email",a);if(410===e?.code)t();else{const t=e?.message?e.message:(0,_.__)("An error occurred while moving the email to the trash.","mailpoet");M("trash_modal_move_to_trash_error",{errorMessage:t}),await o(t,{type:"snackbar",isDismissible:!0,context:"email-editor"})}}}},(0,_.__)("Move to trash","mailpoet"))))}function Jt(){const[e,t]=(0,s.useState)(!1),{urls:a,postId:n}=(0,r.useSelect)((e=>({urls:e(v).getUrls(),postId:e(v).getEmailPostId()})),[]),[l,o]=(0,ae.useEntityProp)("postType","mailpoet_email","status"),{saveEditedEmail:c,updateEmailMailPoetProperty:m}=(0,r.useDispatch)(v);return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.DropdownMenu,{className:"edit-site-more-menu",popoverProps:{className:"edit-site-more-menu__content"},icon:Lt,label:(0,_.__)("More","mailpoet"),onToggle:e=>M("header_more_menu_dropdown_toggle",{isOpened:e})},(({onClose:e})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.MenuGroup,{label:(0,_._x)("View","noun","mailpoet")},(0,i.createElement)(he.PreferenceToggleMenuItem,{scope:"core",name:"fixedToolbar",label:(0,_.__)("Top toolbar","mailpoet"),info:(0,_.__)("Access all block and document tools in a single place","mailpoet"),messageActivated:(0,_.__)("Top toolbar activated","mailpoet"),messageDeactivated:(0,_.__)("Top toolbar deactivated","mailpoet"),onToggle:()=>M("header_more_menu_fixed_toolbar_toggle")}),(0,i.createElement)(he.PreferenceToggleMenuItem,{scope:"core",name:"focusMode",label:(0,_.__)("Spotlight mode","mailpoet"),info:(0,_.__)("Focus at one block at a time","mailpoet"),messageActivated:(0,_.__)("Spotlight mode activated","mailpoet"),messageDeactivated:(0,_.__)("Spotlight mode deactivated","mailpoet"),onToggle:()=>M("header_more_menu_focus_mode_toggle")}),(0,i.createElement)(he.PreferenceToggleMenuItem,{scope:v,name:"fullscreenMode",label:(0,_.__)("Fullscreen mode","mailpoet"),info:(0,_.__)("Work without distraction","mailpoet"),messageActivated:(0,_.__)("Fullscreen mode activated","mailpoet"),messageDeactivated:(0,_.__)("Fullscreen mode deactivated","mailpoet"),shortcut:qt.displayShortcut.secondary("f"),onToggle:()=>M("header_more_menu_fullscreen_mode_toggle")})),(0,i.createElement)(f.MenuGroup,null,"trash"===l?(0,i.createElement)(f.MenuItem,{onClick:async()=>{await o("draft"),await m("deleted_at",""),await c(),M("header_more_menu_restore_from_trash_button_clicked")}},(0,_.__)("Restore from trash","mailpoet")):(0,i.createElement)(f.MenuItem,{onClick:()=>{t(!0),M("header_more_menu_move_to_trash_button_clicked"),e()},isDestructive:!0},(0,_.__)("Move to trash","mailpoet")))))),e&&(0,i.createElement)(Yt,{onClose:()=>t(!1),onRemove:()=>{window.location.href=a.listings},postId:n}))}const Kt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M15 4H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H9c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h6c.3 0 .5.2.5.5v12zm-4.5-.5h2V16h-2v1.5z"})}),Xt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M20.5 16h-.7V8c0-1.1-.9-2-2-2H6.2c-1.1 0-2 .9-2 2v8h-.7c-.8 0-1.5.7-1.5 1.5h20c0-.8-.7-1.5-1.5-1.5zM5.7 8c0-.3.2-.5.5-.5h11.6c.3 0 .5.2.5.5v7.6H5.7V8z"})}),Qt=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),ea=window.wp.url;let ta=function(e){return e.SUCCESS="success",e.ERROR="error",e}({});const aa=(0,s.memo)((function(){const e=(0,s.useRef)(null),{requestSendingNewsletterPreview:t,togglePreviewModal:a,updateSendPreviewEmail:n}=(0,r.useDispatch)(v),{toEmail:l,isSendingPreviewEmail:o,sendingPreviewStatus:c,isModalOpened:m}=(0,r.useSelect)((e=>e(v).getPreviewState()),[]),[p]=(0,ae.useEntityProp)("postType","mailpoet_email","mailpoet_data"),d=()=>{t(p.id,l)},u=()=>{M("send_preview_email_modal_closed"),a(!1)};return(0,s.useEffect)((()=>{m&&(e.current?.focus(),M("send_preview_email_modal_opened"))}),[m]),m?(0,i.createElement)(f.Modal,{className:"mailpoet-send-preview-email",title:(0,_.__)("Send a test email","mailpoet"),onRequestClose:u,focusOnMount:!1},c===ta.ERROR?(0,i.createElement)("div",{className:"mailpoet-send-preview-modal-notice-error"},(0,_.__)("Sorry, we were unable to send this email.","mailpoet"),(0,i.createElement)("ul",null,(0,i.createElement)("li",null,(0,s.createInterpolateElement)((0,_.__)("Please check your <link>sending method configuration</link> with your hosting provider.","mailpoet"),{link:(0,i.createElement)("a",{href:"admin.php?page=mailpoet-settings#mta",target:"_blank",rel:"noopener noreferrer",onClick:()=>M("send_preview_email_modal_check_sending_method_configuration_link_clicked")})})),(0,i.createElement)("li",null,(0,s.createInterpolateElement)((0,_.__)("Or, sign up for MailPoet Sending Service to easily send emails. <link>Sign up for free</link>","mailpoet"),{link:(0,i.createElement)("a",{href:new URL("free-plan","https://www.mailpoet.com/").toString(),key:"sign-up-for-free",target:"_blank",rel:"noopener noreferrer",onClick:()=>M("send_preview_email_modal_sign_up_for_mailpoet_sending_service_link_clicked")})})))):null,(0,i.createElement)("p",null,(0,s.createInterpolateElement)((0,_.__)("Send yourself a test email to test how your email would look like in different email apps. You can also test your spam score by sending a test email to <link1>{$serviceName}</link1>. <link2>Learn more</link2>.","mailpoet").replace("{$serviceName}","Mail Tester"),{link1:(0,i.createElement)("a",{href:"https://www.mail-tester.com/",target:"_blank",rel:"noopener noreferrer",onClick:()=>M("send_preview_email_modal_send_test_email_to_mail_tester_link_clicked")}),link2:(0,i.createElement)("a",{href:"https://kb.mailpoet.com/article/147-test-your-spam-score-with-mail-tester",target:"_blank",rel:"noopener noreferrer",onClick:()=>M("send_preview_email_modal_learn_more_about_mail_tester_link_clicked")})})),(0,i.createElement)(f.TextControl,{label:(0,_.__)("Send to","mailpoet"),onChange:e=>{n(e),B("send_preview_email_modal_send_to_field_updated")},onKeyDown:e=>{const{keyCode:t}=e;t===qt.ENTER&&(e.preventDefault(),d(),M("send_preview_email_modal_send_to_field_key_code_enter"))},value:l,type:"email",ref:e,required:!0}),c===ta.SUCCESS?(0,i.createElement)("p",{className:"mailpoet-send-preview-modal-notice-success"},(0,i.createElement)(gt,{icon:de,style:{fill:"#4AB866"}}),(0,_.__)("Test email sent successfully!","mailpoet")):null,(0,i.createElement)("div",{className:"mailpoet-send-preview-modal-footer"},(0,i.createElement)(f.Button,{variant:"tertiary",onClick:()=>{M("send_preview_email_modal_close_button_clicked"),u()}},(0,_.__)("Close","mailpoet")),(0,i.createElement)(f.Button,{variant:"primary",onClick:()=>{d(),M("send_preview_email_modal_send_test_email_button_clicked")},disabled:o||!(0,ea.isEmail)(l)},o?(0,_.__)("Sending…","mailpoet"):(0,_.__)("Send test email","mailpoet")))):null}));function na(){const[e]=(0,ae.useEntityProp)("postType","mailpoet_email","mailpoet_data"),t=(0,r.useSelect)((e=>e(v).getDeviceType()),[]),{changePreviewDeviceType:a,togglePreviewModal:n}=(0,r.useDispatch)(v),l=e?.preview_url||"",o=e=>{a(e)},s={mobile:Kt,desktop:Xt};return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.DropdownMenu,{className:"mailpoet-preview-dropdown",label:(0,_.__)("Preview","mailpoet"),icon:s[t.toLowerCase()],onToggle:e=>M("header_preview_dropdown_clicked",{isOpened:e})},(({onClose:e})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.MenuGroup,null,(0,i.createElement)(f.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:()=>{o("Desktop"),M("header_preview_dropdown_desktop_selected")},icon:"Desktop"===t&&de},(0,_.__)("Desktop","mailpoet")),(0,i.createElement)(f.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:()=>{o("Mobile"),M("header_preview_dropdown_mobile_selected")},icon:"Mobile"===t&&de},(0,_.__)("Mobile","mailpoet"))),(0,i.createElement)(f.MenuGroup,null,(0,i.createElement)(f.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:()=>{n(!0),M("header_preview_dropdown_send_test_email_selected"),e()}},(0,_.__)("Send a test email","mailpoet"))),l?(0,i.createElement)(f.MenuGroup,null,(0,i.createElement)("div",{className:"edit-post-header-preview__grouping-external"},(0,i.createElement)(f.Button,{className:"edit-post-header-preview__button-external components-menu-item__button",onClick:()=>{var e;M("header_preview_dropdown_preview_in_new_tab_selected"),e=l,window.open(e,"_blank","noreferrer")}},(0,_.__)("Preview in new tab","mailpoet"),(0,i.createElement)(gt,{icon:Qt})))):null))),(0,i.createElement)(aa,null))}const la=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M17.3 10.1c0-2.5-2.1-4.4-4.8-4.4-2.2 0-4.1 1.4-4.6 3.3h-.2C5.7 9 4 10.7 4 12.8c0 2.1 1.7 3.8 3.7 3.8h9c1.8 0 3.2-1.5 3.2-3.3.1-1.6-1.1-2.9-2.6-3.2zm-.5 5.1h-9c-1.2 0-2.2-1.1-2.2-2.3s1-2.4 2.2-2.4h1.3l.3-1.1c.4-1.3 1.7-2.2 3.2-2.2 1.8 0 3.3 1.3 3.3 2.9v1.3l1.3.2c.8.1 1.4.9 1.4 1.8-.1 1-.9 1.8-1.8 1.8z"})});function oa(){const{saveEditedEmail:e}=(0,r.useDispatch)(v),{hasEdits:t,isEmpty:a,isSaving:n}=(0,r.useSelect)((e=>({hasEdits:e(v).hasEdits(),isEmpty:e(v).isEmpty(),isSaving:e(v).isSaving()})),[]),l=!a&&!n&&!t,o=a||n||l;let s=(0,_.__)("Save Draft","mailpoet");return l?s=(0,_.__)("Saved","mailpoet"):n&&(s=(0,_.__)("Saving","mailpoet")),(0,i.createElement)(f.Button,{variant:"tertiary",disabled:o,onClick:()=>{e(),M("header_save_email_button_clicked",{label:s,isSaving:n,isSaved:l})}},n&&(0,i.createElement)(gt,{icon:la}),l&&(0,i.createElement)(gt,{icon:de}),s)}const ia=(0,G.jsx)(H.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,G.jsx)(H.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})});function ra(){const{showIconLabels:e}=(0,r.useSelect)((e=>({showIconLabels:e(v).isFeatureActive("showIconLabels"),postId:e(v).getEmailPostId()})),[]),[t="",a]=(0,ae.useEntityProp)("postType","mailpoet_email","title"),n=(0,s.useRef)(null);return(0,i.createElement)("div",{ref:n,className:"mailpoet-email-editor-campaign-name"},(0,i.createElement)(f.Dropdown,{popoverProps:{placement:"bottom",anchor:n.current},contentClassName:"mailpoet-email-editor-campaign-name__dropdown",renderToggle:({isOpen:a,onToggle:n})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.Button,{onClick:()=>{n(),M("header_campaign_name_email_title_clicked",{isOpen:a})},className:"mailpoet-email-campaign-name__link"},(0,i.createElement)(f.__experimentalText,{size:"body",as:"h1"},(0,i.createElement)(f.VisuallyHidden,{as:"span"},(0,_.__)("Editing email:","mailpoet")),t)),(0,i.createElement)(f.Button,{className:"mailpoet-email-campaign-name__toggle",icon:ia,"aria-expanded":a,"aria-haspopup":"true",onClick:()=>{n(),M("header_campaign_name_toggle_icon_clicked",{isOpen:a})},label:(0,_.__)("Change campaign name","mailpoet")},e&&(0,_.__)("Rename","mailpoet"))),renderContent:()=>(0,i.createElement)("div",{className:"mailpoet-email-editor-email-title-edit"},(0,i.createElement)(f.TextControl,{label:(0,_.__)("Campaign name","mailpoet"),value:t,onChange:e=>{a(e),B("header_campaign_name_title_updated")},name:"campaign_name",help:(0,_.__)("Name your email campaign to indicate its purpose. This would only be visible to you and not shown to your subscribers.","mailpoet")}))}))}function sa({validateContent:e,isContentInvalid:t}){const[a]=(0,ae.useEntityProp)("postType","mailpoet_email","mailpoet_data"),{isDirty:n}=(0,te.useEntitiesSavedStatesIsDirty)(),{hasEmptyContent:l,isEmailSent:o}=(0,r.useSelect)((e=>({hasEmptyContent:e(v).hasEmptyContent(),isEmailSent:e(v).isEmailSent()})),[]),[s]=pt(),c="template"===s||l||o||t||n,m=a;return(0,i.createElement)(f.Button,{variant:"primary",onClick:()=>{M("header_send_button_clicked"),e()&&(window.location.href=`admin.php?page=mailpoet-newsletters#/send/${m.id}`)},disabled:c},(0,_.__)("Send","mailpoet"))}const ca=({onToggle:e})=>((0,s.useEffect)((()=>{document.querySelectorAll(".mailpoet-email-editor-save-button__dropdown  .components-panel__body").forEach((e=>{const t=e.querySelector(".components-panel__body-title button");if(t&&t.textContent.trim()===(0,_.__)("Templates","mailpoet")){const t=e.querySelectorAll(".components-panel__row");t.length&&(t[0].textContent=(0,_.__)("This change will affect emails that use this template.","mailpoet"))}}))}),[]),(0,i.createElement)(te.EntitiesSavedStates,{close:e}));function ma(){const{isSaving:e}=(0,r.useSelect)((e=>({isSaving:e(v).isSaving()})),[]),t=(0,s.useRef)(null);let a=(0,_.__)("Save","mailpoet");return e&&(a=(0,_.__)("Saving","mailpoet")),(0,i.createElement)("div",{ref:t},(0,i.createElement)(f.Dropdown,{popoverProps:{placement:"bottom",anchor:t.current},contentClassName:"mailpoet-email-editor-save-button__dropdown",renderToggle:({onToggle:t})=>(0,i.createElement)(f.Button,{onClick:()=>{M("header_save_all_button_save_button_clicked"),t()},variant:"primary",disabled:e},a),renderContent:({onToggle:e})=>(0,i.createElement)(ca,{onToggle:e})}))}const pa=window.wp.isShallowEqual;var da=a.n(pa);function ua(e){const t=(0,s.useRef)(e);return da()(e,t.current)||(t.current=e),t.current}const _a=()=>{const e="email-validation",t=(0,r.useSelect)((t=>t(Zt.store).getNotices(e)));return{notices:t,hasValidationNotice:(0,s.useCallback)((e=>e?void 0!==t.find((t=>t.id===e)):t?.length>0),[t]),addValidationNotice:(0,s.useCallback)(((t,a,n=[])=>{(0,r.dispatch)(Zt.store).createNotice("error",a,{id:t,isDismissible:!1,actions:n,context:e})}),[e]),removeValidationNotice:(0,s.useCallback)((t=>{(0,r.dispatch)(Zt.store).removeNotice(t,e)}),[e])}},ga=f.ToolbarItem,ha=p.BlockToolbar;function ya(){const e=(0,s.useRef)(),t=(0,s.useRef)(),a=(0,s.useRef)(),n=(0,s.useRef)(),[l,o]=(0,s.useState)(!1),{undo:c,redo:m}=(0,r.useDispatch)(ae.store),{setIsInserterOpened:d,setIsListViewOpened:u}=(0,r.useDispatch)(te.store),{isInserterSidebarOpened:g,isListviewSidebarOpened:h,isFixedToolbarActive:y,isBlockSelected:E,hasUndo:b,hasRedo:w}=(0,r.useSelect)((e=>({isInserterSidebarOpened:e(te.store).isInserterOpened(),isListviewSidebarOpened:e(te.store).isListViewOpened(),isFixedToolbarActive:e(he.store).get("core","fixedToolbar"),isBlockSelected:!!e(p.store).getBlockSelectionStart(),hasUndo:e(ae.store).hasUndo(),hasRedo:e(ae.store).hasRedo()})),[]),[k]=pt(),{validateContent:S,isInvalid:x}=(()=>{const{contentBlockId:e,hasFooter:t}=(0,r.useSelect)((e=>{const t=e(p.store).getBlocks().filter((e=>"mailpoet/powered-by-mailpoet"!==e.name&&"core/post-content"!==e.name)),a=e(p.store).getBlocksByName("core/post-content");return{contentBlockId:a?.[0],hasFooter:t.length>0}})),{addValidationNotice:a,hasValidationNotice:n,removeValidationNotice:l}=_a(),{editedContent:o,editedTemplateContent:i,postTemplateId:c}=(0,r.useSelect)((e=>({editedContent:e(v).getEditedEmailContent(),editedTemplateContent:e(v).getCurrentTemplateContent(),postTemplateId:e(v).getCurrentTemplate()?.id}))),m=ua(o),d=ua(i),u=`<a data-link-href='[mailpoet/subscription-unsubscribe-url]' contenteditable='false' style='text-decoration: underline;' class='mailpoet-email-editor__personalization-tags-link'>${(0,_.__)("Unsubscribe","mailpoet")}</a> | <a data-link-href='[mailpoet/subscription-manage-url]' contenteditable='false' style='text-decoration: underline;' class='mailpoet-email-editor__personalization-tags-link'>${(0,_.__)("Manage subscription","mailpoet")}</a>`,g=(0,s.useMemo)((()=>{const a=(0,V.createBlock)("core/paragraph",{align:"center",fontSize:"small",content:u});return[{id:"missing-unsubscribe-link",test:e=>!e.includes("[mailpoet/subscription-unsubscribe-url]"),message:(0,_.__)('All emails must include an "Unsubscribe" link.',"mailpoet"),actions:[{label:(0,_.__)("Insert link","mailpoet"),onClick:()=>{t?(0,r.dispatch)(ae.store).editEntityRecord("postType","wp_template",c,{content:`\n                      ${i}\n                      \x3c!-- wp:paragraph {"align":"center","fontSize":"small"} --\x3e\n                      ${u}\n                      \x3c!-- /wp:paragraph --\x3e\n                    `}):(0,r.dispatch)(p.store).insertBlock(a,void 0,e)}}]}]}),[e,t,u,c,i]),h=(0,s.useCallback)((()=>{let e=!0;return g.forEach((({id:t,test:o,message:i,actions:r})=>{o(m+d)?(a(t,i,r),e=!1):n(t)&&l(t)})),e}),[m,d,a,l,n,g]);return(0,r.subscribe)((()=>{n()&&h()}),v),{isInvalid:n(),validateContent:h}})(),{dirtyEntityRecords:C}=(0,te.useEntitiesSavedStatesIsDirty)(),T=C.some((e=>"mailpoet_email"!==e.name)),N=e=>{e.preventDefault()},P=g?(0,_.__)("Close","mailpoet"):(0,_.__)("Add","mailpoet");return(0,i.createElement)("div",{className:"editor-header edit-post-header"},(0,i.createElement)("div",{className:"editor-header__toolbar"},(0,i.createElement)(p.NavigableToolbar,{className:"editor-document-tools edit-post-header-toolbar is-unstyled","aria-label":(0,_.__)("Email document tools","mailpoet")},(0,i.createElement)("div",{className:"editor-document-tools__left"},(0,i.createElement)(ga,{ref:e,as:f.Button,className:"editor-header-toolbar__inserter-toggle edit-post-header-toolbar__inserter-toggle",variant:"primary",isPressed:g,onMouseDown:N,onClick:()=>g?(M("header_inserter_sidebar_closed"),d(!1)):(M("header_inserter_sidebar_opened"),d(!0)),disabled:!1,icon:Vt,label:P,showTooltip:!0,"aria-expanded":g}),(0,i.createElement)(ga,{ref:a,as:f.Button,className:"editor-history__undo",isPressed:!1,onMouseDown:N,onClick:()=>{c(),M("header_undo_icon_clicked")},disabled:!b,icon:Ht,label:(0,_.__)("Undo","mailpoet"),showTooltip:!0}),(0,i.createElement)(ga,{ref:n,as:f.Button,className:"editor-history__redo",isPressed:!1,onMouseDown:N,onClick:()=>{m(),M("header_redo_icon_clicked")},disabled:!w,icon:Gt,label:(0,_.__)("Redo","mailpoet"),showTooltip:!0}),(0,i.createElement)(ga,{ref:t,as:f.Button,className:"editor-header-toolbar__document-overview-toggle edit-post-header-toolbar__document-overview-toggle",isPressed:h,onMouseDown:N,onClick:()=>h?(M("header_listview_sidebar_closed"),u(!1)):(M("header_listview_sidebar_opened"),u(!0)),disabled:!1,icon:$t,label:(0,_.__)("List view","mailpoet"),showTooltip:!0,"aria-expanded":g}))),y&&E&&(0,i.createElement)(i.Fragment,null,(0,i.createElement)("div",{className:O()("editor-collapsible-block-toolbar",{"is-collapsed":l})},(0,i.createElement)(ha,{hideDragHandle:!0})),(0,i.createElement)(f.Button,{className:"editor-header__block-tools-toggle edit-post-header__block-tools-toggle",icon:l?Ut:Wt,onClick:()=>{o((e=>!e)),M("header_blocks_tool_button_clicked",{isBlockToolsCollapsed:l})},label:l?(0,_.__)("Show block tools","mailpoet"):(0,_.__)("Hide block tools","mailpoet")}))),(!y||!E||l)&&(0,i.createElement)("div",{className:"editor-header__center edit-post-header__center"},"template"===k?(0,i.createElement)(te.DocumentBar,null):(0,i.createElement)(ra,null)),(0,i.createElement)("div",{className:"editor-header__settings edit-post-header__settings"},(0,i.createElement)(oa,null),(0,i.createElement)(na,null),T?(0,i.createElement)(ma,null):(0,i.createElement)(sa,{validateContent:S,isContentInvalid:x}),(0,i.createElement)(Ze.Slot,{scope:v}),(0,i.createElement)(Jt,null)))}function fa(){return(0,i.createElement)("div",{className:"editor-list-view-sidebar"},(0,i.createElement)(p.__experimentalListView,null))}function Ea(){const{postContentId:e}=(0,r.useSelect)((e=>{const t=e(p.store).getBlocks();return{postContentId:t.find((e=>"core/post-content"===e.name))?.clientId}})),[t]=pt(),{setIsInserterOpened:a}=(0,r.useDispatch)(te.store);return(0,i.createElement)("div",{className:"editor-inserter-sidebar"},(0,i.createElement)("div",{className:"editor-inserter-sidebar__content"},(0,i.createElement)(p.__experimentalLibrary,{showMostUsedBlocks:!0,showInserterHelpPanel:!1,rootClientId:"email"===t?e:null,onClose:()=>{a(!1),M("inserter_sidebar_library_close_icon_clicked",{editorMode:t})},onSelect:e=>{M("inserter_sidebar_library_block_selected",{editorMode:t,blockName:e?.name})}})))}function ba(){const{isEmailSent:e}=(0,r.useSelect)((e=>({isEmailSent:e(v).isEmailSent()})),[]);return(0,s.useEffect)((()=>{e&&((0,r.dispatch)(Zt.store).createNotice("warning",(0,_.__)("This email has already been sent. It can be edited, but not sent again. Duplicate this email if you want to send it again.","mailpoet"),{id:"email-sent",isDismissible:!1,context:"email-editor"}),M("editor_showed_email_sent_notice"))}),[e]),null}function va(){const{notices:e}=_a();return 0===e.length?null:(0,i.createElement)(f.Notice,{status:"error",className:"mailpoet-email-editor-validation-errors components-editor-notices__pinned",isDismissible:!1},(0,i.createElement)(i.Fragment,null,(0,i.createElement)("strong",null,(0,_.__)("Fix errors to continue:","mailpoet")),(0,i.createElement)("ul",null,e.map((({id:e,content:t,actions:a})=>(0,i.createElement)("li",{key:e},t,a.length>0?a.map((({label:e,onClick:t})=>(0,i.createElement)(f.Button,{key:e,onClick:t,variant:"link"},e))):null))))))}function wa({context:e="email-editor"}){const{notices:t}=(0,r.useSelect)((t=>({notices:t(Zt.store).getNotices(e)})),[e]),a=(0,s.useMemo)((()=>({"site-editor-save-success":{content:(0,_.__)("Email design updated.","mailpoet"),removeActions:!0}})),[]),{removeNotice:n}=(0,r.useDispatch)(Zt.store),l=t.filter((({type:e})=>"snackbar"===e)).map((e=>a[e.id]?{...e,content:a[e.id].content,actions:a[e.id].removeActions?[]:e.actions}:e));return(0,i.createElement)(f.SnackbarList,{notices:l,className:"components-editor-notices__snackbar",onRemove:t=>n(t,e)})}function ka(){const{notices:e}=(0,r.useSelect)((e=>({notices:e(Zt.store).getNotices("email-editor")})),[]),{removeNotice:t}=(0,r.useDispatch)(Zt.store),a=e.filter((({isDismissible:e,type:t})=>e&&"default"===t)),n=e.filter((({isDismissible:e,type:t})=>!e&&"default"===t));return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(f.NoticeList,{notices:n,className:"components-editor-notices__pinned"}),(0,i.createElement)(f.NoticeList,{notices:a,className:"components-editor-notices__dismissible",onRemove:e=>t(e,"email-editor")}),(0,i.createElement)(va,null),(0,i.createElement)(wa,{context:"global"}),(0,i.createElement)(wa,{context:"email-editor"}))}const Sa=(0,G.jsx)(H.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,G.jsx)(H.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M20 12a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 0 1-6.5 6.5v-13a6.5 6.5 0 0 1 6.5 6.5Z"})}),xa=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M6.9 7L3 17.8h1.7l1-2.8h4.1l1 2.8h1.7L8.6 7H6.9zm-.7 6.6l1.5-4.3 1.5 4.3h-3zM21.6 17c-.1.1-.2.2-.3.2-.1.1-.2.1-.4.1s-.3-.1-.4-.2c-.1-.1-.1-.3-.1-.6V12c0-.5 0-1-.1-1.4-.1-.4-.3-.7-.5-1-.2-.2-.5-.4-.9-.5-.4 0-.8-.1-1.3-.1s-1 .1-1.4.2c-.4.1-.7.3-1 .4-.2.2-.4.3-.6.5-.1.2-.2.4-.2.7 0 .3.1.5.2.8.2.2.4.3.8.3.3 0 .6-.1.8-.3.2-.2.3-.4.3-.7 0-.3-.1-.5-.2-.7-.2-.2-.4-.3-.6-.4.2-.2.4-.3.7-.4.3-.1.6-.1.8-.1.3 0 .6 0 .8.1.2.1.4.3.5.5.1.2.2.5.2.9v1.1c0 .3-.1.5-.3.6-.2.2-.5.3-.9.4-.3.1-.7.3-1.1.4-.4.1-.8.3-1.1.5-.3.2-.6.4-.8.7-.2.3-.3.7-.3 1.2 0 .6.2 1.1.5 1.4.3.4.9.5 1.6.5.5 0 1-.1 1.4-.3.4-.2.8-.6 1.1-1.1 0 .4.1.7.3 1 .2.3.6.4 1.2.4.4 0 .7-.1.9-.2.2-.1.5-.3.7-.4h-.3zm-3-.9c-.2.4-.5.7-.8.8-.3.2-.6.2-.8.2-.4 0-.6-.1-.9-.3-.2-.2-.3-.6-.3-1.1 0-.5.1-.9.3-1.2s.5-.5.8-.7c.3-.2.7-.3 1-.5.3-.1.6-.3.7-.6v3.4z"})}),Ca=(0,G.jsx)(H.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,G.jsx)(H.Path,{d:"M17.2 10.9c-.5-1-1.2-2.1-2.1-3.2-.6-.9-1.3-1.7-2.1-2.6L12 4l-1 1.1c-.6.9-1.3 1.7-2 2.6-.8 1.2-1.5 2.3-2 3.2-.6 1.2-1 2.2-1 3 0 3.4 2.7 6.1 6.1 6.1s6.1-2.7 6.1-6.1c0-.8-.3-1.8-1-3zm-5.1 7.6c-2.5 0-4.6-2.1-4.6-4.6 0-.3.1-1 .8-2.3.5-.9 1.1-1.9 2-3.1.7-.9 1.3-1.7 1.8-2.3.7.8 1.3 1.6 1.8 2.3.8 1.1 1.5 2.2 2 3.1.7 1.3.8 2 .8 2.3 0 2.5-2.1 4.6-4.6 4.6z"})}),Ta={start:{scale:1,opacity:1},hover:{scale:0,opacity:0}},Na={hover:{opacity:1},start:{opacity:.5}},Pa={hover:{scale:1,opacity:1},start:{scale:0,opacity:0}};function Ia({label:e,isFocused:t,withHoverView:a}){const{styles:n,colors:l}=(0,r.useSelect)((e=>({styles:e(v).getStyles(),colors:e(v).getPaletteColors()})),[]),o=n?.color?.background||"#ffffff",c=n?.elements?.heading?.typography?.fontFamily||"inherit",m=n?.elements?.heading?.color?.text||"inherit",p=n?.elements?.heading?.typography?.fontWeight||"inherit",d=l.theme.concat(l.theme),u=d.filter((({color:e})=>e.toLowerCase()!==o.toLowerCase()&&e.toLowerCase()!==m.toLowerCase())).slice(0,2),[_,g]=(0,s.useState)(!1);return(0,i.createElement)("div",{onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1)},(0,i.createElement)(f.__unstableMotion.div,{style:{height:152,width:"100%",background:o,cursor:a?"pointer":void 0},initial:"start",animate:(_||t)&&e?"hover":"start"},(0,i.createElement)(f.__unstableMotion.div,{variants:Ta,style:{height:"100%",overflow:"hidden"}},(0,i.createElement)(f.__experimentalHStack,{spacing:10,justify:"center",style:{height:"100%",overflow:"hidden"}},(0,i.createElement)(f.__unstableMotion.div,{style:{fontFamily:c,fontSize:65,color:m,fontWeight:p},animate:{scale:1,opacity:1},initial:{scale:.1,opacity:0},transition:{delay:.3,type:"tween"}},"Aa"),(0,i.createElement)(f.__experimentalVStack,{spacing:4},u.map((({slug:e,color:t},a)=>(0,i.createElement)(f.__unstableMotion.div,{key:e,style:{height:32,width:32,background:t,borderRadius:16},animate:{scale:1,opacity:1},initial:{scale:.1,opacity:0},transition:{delay:1===a?.2:.1}})))))),(0,i.createElement)(f.__unstableMotion.div,{variants:a&&Na,style:{height:"100%",width:"100%",position:"absolute",top:0,overflow:"hidden",filter:"blur(60px)",opacity:.1}},(0,i.createElement)(f.__experimentalHStack,{spacing:0,justify:"flex-start",style:{height:"100%",overflow:"hidden"}},d.slice(0,4).map((({color:e})=>(0,i.createElement)("div",{key:e,style:{height:"100%",background:e,flexGrow:1}}))))),(0,i.createElement)(f.__unstableMotion.div,{variants:Pa,style:{height:"100%",width:"100%",overflow:"hidden",position:"absolute",top:0}},(0,i.createElement)(f.__experimentalVStack,{spacing:3,justify:"center",style:{height:"100%",overflow:"hidden",padding:10,boxSizing:"border-box"}},e&&(0,i.createElement)("div",{style:{fontSize:40,fontFamily:c,color:m,fontWeight:p,lineHeight:"1em",textAlign:"center"}},e)))))}function Ma(){return(0,i.createElement)(f.Card,{size:"small",className:"edit-site-global-styles-screen-root",variant:"primary"},(0,i.createElement)(f.CardBody,null,(0,i.createElement)(f.__experimentalVStack,{spacing:4},(0,i.createElement)(f.Card,null,(0,i.createElement)(f.CardMedia,null,(0,i.createElement)(Ia,null))),(0,i.createElement)(f.__experimentalItemGroup,null,(0,i.createElement)(f.__experimentalNavigatorButton,{path:"/typography",onClick:()=>M("styles_sidebar_navigation_click",{path:"typography"})},(0,i.createElement)(f.__experimentalItem,null,(0,i.createElement)(f.__experimentalHStack,{justify:"flex-start"},(0,i.createElement)(f.Icon,{icon:xa,size:24}),(0,i.createElement)(f.FlexItem,null,(0,_.__)("Typography","mailpoet"))))),(0,i.createElement)(f.__experimentalNavigatorButton,{path:"/colors",onClick:()=>M("styles_sidebar_navigation_click",{path:"colors"})},(0,i.createElement)(f.__experimentalItem,null,(0,i.createElement)(f.__experimentalHStack,{justify:"flex-start"},(0,i.createElement)(f.Icon,{icon:Ca,size:24}),(0,i.createElement)(f.FlexItem,null,(0,_.__)("Colors","mailpoet"))))),(0,i.createElement)(f.__experimentalNavigatorButton,{path:"/layout",onClick:()=>M("styles_sidebar_navigation_click",{path:"layout"})},(0,i.createElement)(f.__experimentalItem,null,(0,i.createElement)(f.__experimentalHStack,{justify:"flex-start"},(0,i.createElement)(f.Icon,{icon:At,size:24}),(0,i.createElement)(f.FlexItem,null,(0,_.__)("Layout","mailpoet")))))))))}function Ba(e){const t=e=>{if("object"==typeof e&&null!==e||void 0===e){if(Array.isArray(e)&&0===e.length)return;for(const a in e)if(e.hasOwnProperty(a)){const n=t(e[a]);void 0===n?delete e[a]:e[a]=n}}return e};return t(e)}const Aa=()=>{const{userTheme:e,updateUserTheme:t}=rt(),a=(0,s.useMemo)((()=>Ba(function(e){const t=e=>{if("object"==typeof e&&null!==e)for(const a in e)e.hasOwnProperty(a)&&(e[a]=t(e[a]));else if("string"==typeof e)return e.replace(/var\(--([a-z]+)--([a-z]+(?:--[a-z0-9]+(?:-[a-z0-9]+)*)*)--([a-z0-9-]+)\)/g,((e,t,a,n)=>`var:${a.split("--").concat(n).join("|")}`));return e};return t(e)}(e?.styles))),[e]),{styles:n}=(0,r.useSelect)((e=>({styles:e(v).getStyles()}))),l=(0,s.useCallback)((a=>{const n={...e,styles:Ba(a)};t(n)}),[t,e]),o=(0,s.useCallback)(((a,n)=>{const l=function(e,t,a){const n=Array.isArray(t)?[...t]:[t],l=Array.isArray(e)?[...e]:{...e},o=n.pop();let i=l;return n.forEach((e=>{const t=i[e];i[e]=Array.isArray(t)?[...t]:{...t},i=i[e]})),i[o]=a,l}(e,["styles",...a],n);t(l)}),[t,e]);return{styles:it().all([n||{},a||{}]),userStyles:e?.styles,defaultStyles:n,updateStyleProp:o,updateStyles:l}},La={typography:{},color:{}},Ra=(e,t,a="heading",n=!1)=>{switch(t){case"text":return{typography:e.typography,color:e.color};case"heading":return((e,t="heading",a=!1)=>a?it().all([La,e.elements.heading||{},e.elements[t]||{}]):{...La,...e.elements.heading||{},...e.elements[t]||{}})(e,null!=a?a:"heading",n);default:return e.elements[t]||La}};function za({element:e,label:t}){const{styles:a}=Aa(),n=Ra(a,e,null,!0),{fontFamily:l,fontStyle:o,fontWeight:r,letterSpacing:s,textDecoration:c,textTransform:m}=n.typography,p=n.color?.text||"inherit",d=n.color?.background||"#f0f0f0",u=(0,_.sprintf)(
// translators: %s: is a subset of Typography, e.g., 'text' or 'links'.
// translators: %s: is a subset of Typography, e.g., 'text' or 'links'.
(0,_.__)("Typography %s styles","mailpoet"),t);return(0,i.createElement)(f.__experimentalItem,null,(0,i.createElement)(f.__experimentalNavigatorButton,{path:`/typography/${e}`,"aria-label":u,onClick:()=>M("styles_sidebar_screen_typography_button_click",{element:e,label:t,path:`typography/${e}`})},(0,i.createElement)(f.__experimentalHStack,{justify:"flex-start"},(0,i.createElement)(f.FlexItem,{className:"edit-site-global-styles-screen-typography__indicator",style:{fontFamily:null!=l?l:"serif",background:d,color:p,fontStyle:null!=o?o:"normal",fontWeight:null!=r?r:"normal",letterSpacing:null!=s?s:"normal",textDecoration:null!=c?c:"link"===e?"underline":"none",textTransform:null!=m?m:"none"}},"Aa"),(0,i.createElement)(f.FlexItem,null,t))))}const Fa=function(){return(0,i.createElement)(f.Card,{size:"small",variant:"primary",isBorderless:!0},(0,i.createElement)(f.CardBody,null,(0,i.createElement)(f.__experimentalVStack,{spacing:3},(0,i.createElement)(f.__experimentalHeading,{level:3,className:"edit-site-global-styles-subtitle"},(0,_.__)("Elements","mailpoet")),(0,i.createElement)(f.__experimentalItemGroup,{isBordered:!0,isSeparated:!0,size:"small"},(0,i.createElement)(za,{element:"text",label:(0,_.__)("Text","mailpoet")}),(0,i.createElement)(za,{element:"link",label:(0,_.__)("Links","mailpoet")}),(0,i.createElement)(za,{element:"heading",label:(0,_.__)("Headings","mailpoet")}),(0,i.createElement)(za,{element:"button",label:(0,_.__)("Buttons","mailpoet")})))))},ja=(0,G.jsx)(H.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,G.jsx)(H.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})});function Da({title:e,description:t,onBack:a}){return(0,i.createElement)(f.__experimentalVStack,{spacing:0},(0,i.createElement)(f.__experimentalView,null,(0,i.createElement)(f.__experimentalSpacer,{marginBottom:0,paddingX:4,paddingY:3},(0,i.createElement)(f.__experimentalHStack,{spacing:2},(0,i.createElement)(f.__experimentalNavigatorToParentButton,{style:{minWidth:24,padding:0},icon:ja,size:"small","aria-label":(0,_.__)("Navigate to the previous view","mailpoet"),onClick:a}),(0,i.createElement)(f.__experimentalSpacer,null,(0,i.createElement)(f.__experimentalHeading,{className:"mailpoet-email-editor__styles-header",level:2,size:13},e))))),t&&(0,i.createElement)("p",{className:"mailpoet-email-editor__styles-header-description"},t))}const Oa=Da;function Va(){return B("styles_sidebar_screen_typography_opened"),(0,i.createElement)(i.Fragment,null,(0,i.createElement)(Oa,{title:(0,_.__)("Typography","mailpoet"),description:(0,_.__)("Manage the typography settings for different elements.","mailpoet")}),(0,i.createElement)(Fa,null))}const Ha={fontFamily:!0,fontSize:!0,fontAppearance:!0,lineHeight:!0,letterSpacing:!1,textTransform:!1,textDecoration:!1,writingMode:!0,textColumns:!0},Ga=function({element:e,headingLevel:t,defaultControls:a=Ha}){const[n,l]=(0,p.useSettings)("typography.fontSizes","typography.fontFamilies"),o=l?.default||[],{styles:r,defaultStyles:c,updateStyleProp:m}=Aa(),d=Ra(r,e,t),u=Ra(c,e,t),{fontFamily:g,fontSize:h,fontStyle:y,fontWeight:E,lineHeight:b,letterSpacing:v,textDecoration:w,textTransform:k}=d.typography,{fontFamily:S,fontSize:x,fontStyle:C,fontWeight:T,lineHeight:N,letterSpacing:P,textDecoration:I,textTransform:B}=u.typography,L="heading"!==e||"heading"!==t,R=(0,s.useCallback)(((a,n)=>{m("heading"===e?["elements",t,...a]:"text"===e?[...a]:["elements",e,...a],n)}),[e,m,t]),z=t=>{R(["typography","letterSpacing"],t),A("styles_sidebar_screen_typography_element_panel_set_letter_spacing",{element:e,newValue:t,selectedDefaultLetterSpacing:t===P})},F=t=>{R(["typography","lineHeight"],t),A("styles_sidebar_screen_typography_element_panel_set_line_height",{element:e,newValue:t,selectedDefaultLineHeight:t===N})},j=a=>{R(["typography","fontSize"],a),A("styles_sidebar_screen_typography_element_panel_set_font_size",{element:e,headingLevel:t,newValue:a,selectedDefaultFontSize:a===x})},D=t=>{R(["typography","fontFamily"],t),A("styles_sidebar_screen_typography_element_panel_set_font_family",{element:e,newValue:t,selectedDefaultFontFamily:t===S})},O=t=>{R(["typography","textDecoration"],t),A("styles_sidebar_screen_typography_element_panel_set_text_decoration",{element:e,newValue:t,selectedDefaultTextDecoration:t===I})},V=t=>{R(["typography","textTransform"],t),A("styles_sidebar_screen_typography_element_panel_set_text_transform",{element:e,newValue:t,selectedDefaultTextTransform:t===B})},H=({fontStyle:t,fontWeight:a})=>{R(["typography","fontStyle"],t),R(["typography","fontWeight"],a),A("styles_sidebar_screen_typography_element_panel_set_font_appearance",{element:e,newFontStyle:t,newFontWeight:a,selectedDefaultFontStyle:t===C,selectedDefaultFontWeight:a===T})};return(0,i.createElement)(f.__experimentalToolsPanel,{label:(0,_.__)("Typography","mailpoet"),resetAll:()=>{R(["typography"],u.typography),M("styles_sidebar_screen_typography_element_panel_reset_all_styles_selected",{element:e,headingLevel:t})}},(0,i.createElement)(f.__experimentalToolsPanelItem,{label:(0,_.__)("Font family","mailpoet"),hasValue:()=>g!==S,onDeselect:()=>D(S),isShownByDefault:a.fontFamily},(0,i.createElement)(p.__experimentalFontFamilyControl,{value:g,onChange:D,size:"__unstable-large",fontFamilies:o,__nextHasNoMarginBottom:!0})),L&&(0,i.createElement)(f.__experimentalToolsPanelItem,{label:(0,_.__)("Font size","mailpoet"),hasValue:()=>h!==x,onDeselect:()=>j(x),isShownByDefault:a.fontSize},(0,i.createElement)(f.FontSizePicker,{value:h,onChange:j,fontSizes:n,disableCustomFontSizes:!1,withReset:!1,withSlider:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0})),(0,i.createElement)(f.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Appearance","mailpoet"),hasValue:()=>E!==T||y!==C,onDeselect:()=>{H({fontStyle:C,fontWeight:T})},isShownByDefault:a.fontAppearance},(0,i.createElement)(p.__experimentalFontAppearanceControl,{value:{fontStyle:y,fontWeight:E},onChange:H,hasFontStyles:!0,hasFontWeights:!0,size:"__unstable-large"})),(0,i.createElement)(f.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Line height","mailpoet"),hasValue:()=>b!==N,onDeselect:()=>F(N),isShownByDefault:a.lineHeight},(0,i.createElement)(p.LineHeightControl,{__nextHasNoMarginBottom:!0,__unstableInputWidth:"auto",value:b,onChange:F,size:"__unstable-large"})),(0,i.createElement)(f.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Letter spacing","mailpoet"),hasValue:()=>v!==P,onDeselect:()=>z(P),isShownByDefault:a.letterSpacing},(0,i.createElement)(p.__experimentalLetterSpacingControl,{value:v,onChange:z,size:"__unstable-large",__unstableInputWidth:"auto"})),(0,i.createElement)(f.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Text decoration","mailpoet"),hasValue:()=>w!==I,onDeselect:()=>O(I),isShownByDefault:a.textDecoration},(0,i.createElement)(p.__experimentalTextDecorationControl,{value:w,onChange:O,size:"__unstable-large",__unstableInputWidth:"auto"})),(0,i.createElement)(f.__experimentalToolsPanelItem,{label:(0,_.__)("Letter case","mailpoet"),hasValue:()=>k!==B,onDeselect:()=>V(B),isShownByDefault:a.textTransform},(0,i.createElement)(p.__experimentalTextTransformControl,{value:k,onChange:V,showNone:!0,isBlock:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0})))};function $a({element:e,headingLevel:t}){const{styles:a}=Aa(),n=Ra(a,e,t,!0),{fontFamily:l,fontSize:o,fontStyle:r,fontWeight:s,lineHeight:c,letterSpacing:m,textDecoration:p,textTransform:d}=n.typography,u=n.color?.text||"inherit",_=n.color?.background||"#f0f0f0",g="link"===e?{textDecoration:null!=p?p:"underline"}:{};return(0,i.createElement)("div",{className:"edit-site-typography-preview",style:{fontFamily:null!=l?l:"serif",background:_,color:u,lineHeight:c,fontSize:o,fontStyle:r,fontWeight:s,letterSpacing:m,textDecoration:p,textTransform:d,...g}},"Aa")}const Ua={text:{title:(0,_.__)("Text","mailpoet"),description:(0,_.__)("Manage the fonts and typography used on text.","mailpoet"),defaultControls:Ha},link:{title:(0,_.__)("Links","mailpoet"),description:(0,_.__)("Manage the fonts and typography used on links.","mailpoet"),defaultControls:{...Ha,textDecoration:!0}},heading:{title:(0,_.__)("Headings","mailpoet"),description:(0,_.__)("Manage the fonts and typography used on headings.","mailpoet"),defaultControls:{...Ha,textTransform:!0}},button:{title:(0,_.__)("Buttons","mailpoet"),description:(0,_.__)("Manage the fonts and typography used on buttons.","mailpoet"),defaultControls:Ha}};function Wa({element:e}){B("styles_sidebar_screen_typography_element_opened",{element:e});const[t,a]=(0,s.useState)("heading");return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(Oa,{title:Ua[e].title,description:Ua[e].description}),(0,i.createElement)(f.__experimentalSpacer,{marginX:4},(0,i.createElement)($a,{element:e,headingLevel:t})),"heading"===e&&(0,i.createElement)(f.__experimentalSpacer,{marginX:4,marginBottom:"1em"},(0,i.createElement)(f.__experimentalToggleGroupControl,{label:(0,_.__)("Select heading level","mailpoet"),hideLabelFromVision:!0,value:t,onChange:e=>{a(e.toString()),M("styles_sidebar_screen_typography_element_heading_level_selected",{value:e})},isBlock:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0},(0,i.createElement)(f.__experimentalToggleGroupControlOption,{value:"heading",label:(0,_._x)("All","heading levels","mailpoet")}),(0,i.createElement)(f.__experimentalToggleGroupControlOption,{value:"h1",label:(0,_._x)("H1","Heading Level","mailpoet")}),(0,i.createElement)(f.__experimentalToggleGroupControlOption,{value:"h2",label:(0,_._x)("H2","Heading Level","mailpoet")}),(0,i.createElement)(f.__experimentalToggleGroupControlOption,{value:"h3",label:(0,_._x)("H3","Heading Level","mailpoet")}),(0,i.createElement)(f.__experimentalToggleGroupControlOption,{value:"h4",label:(0,_._x)("H4","Heading Level","mailpoet")}),(0,i.createElement)(f.__experimentalToggleGroupControlOption,{value:"h5",label:(0,_._x)("H5","Heading Level","mailpoet")}),(0,i.createElement)(f.__experimentalToggleGroupControlOption,{value:"h6",label:(0,_._x)("H6","Heading Level","mailpoet")}))),(0,i.createElement)(Ga,{element:e,headingLevel:t,defaultControls:Ua[e].defaultControls}))}function qa(){B("styles_sidebar_screen_colors_opened");const{userStyles:e,styles:t,updateStyles:a}=Aa(),n=(0,r.useSelect)((e=>e(v).getTheme()),[]);return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(Oa,{title:(0,_.__)("Colors","mailpoet"),description:(0,_.__)("Manage palettes and the default color of different global elements.","mailpoet")}),(0,i.createElement)(re,{value:e,inheritedValue:t,onChange:e=>{a(e),M("styles_sidebar_screen_colors_styles_updated")},settings:n?.settings,panelId:"colors"}))}function Za(){const[e]=(0,p.useSettings)("spacing.units"),t=(0,f.__experimentalUseCustomUnits)({availableUnits:e}),{styles:a,defaultStyles:n,updateStyleProp:l}=Aa();return(0,i.createElement)(f.__experimentalToolsPanel,{label:(0,_.__)("Dimensions","mailpoet"),resetAll:()=>{l(["spacing"],n.spacing),M("styles_sidebar_screen_layout_dimensions_reset_all_selected")}},(0,i.createElement)(f.__experimentalToolsPanelItem,{isShownByDefault:!0,hasValue:()=>!(0,T.isEqual)(a.spacing.padding,n.spacing.padding),label:(0,_.__)("Padding","mailpoet"),onDeselect:()=>{l(["spacing","padding"],n.spacing.padding),M("styles_sidebar_screen_layout_dimensions_padding_reset_clicked")},className:"tools-panel-item-spacing"},(0,i.createElement)(p.__experimentalSpacingSizesControl,{allowReset:!0,values:a.spacing.padding,onChange:e=>{l(["spacing","padding"],e),A("styles_sidebar_screen_layout_dimensions_padding_updated",{value:e})},label:(0,_.__)("Padding","mailpoet"),sides:["horizontal","vertical","top","left","right","bottom"],units:t})),(0,i.createElement)(f.__experimentalToolsPanelItem,{isShownByDefault:!0,label:(0,_.__)("Block spacing","mailpoet"),hasValue:()=>a.spacing.blockGap!==n.spacing.blockGap,onDeselect:()=>{l(["spacing","blockGap"],n.spacing.blockGap),M("styles_sidebar_screen_layout_dimensions_block_spacing_reset_clicked")},className:"tools-panel-item-spacing"},(0,i.createElement)(p.__experimentalSpacingSizesControl,{label:(0,_.__)("Block spacing","mailpoet"),min:0,onChange:e=>{l(["spacing","blockGap"],e.top),A("styles_sidebar_screen_layout_dimensions_block_spacing_updated",{value:e})},showSideInLabel:!1,sides:["top"],values:{top:a.spacing.blockGap},allowReset:!0})))}function Ya(){return B("styles_sidebar_screen_layout_opened"),(0,i.createElement)(i.Fragment,null,(0,i.createElement)(Da,{title:(0,_.__)("Layout","mailpoet")}),(0,i.createElement)(Za,null))}const Ja=(0,s.memo)((function(e){return(0,i.createElement)(Xe,{identifier:"email-editor/editor/styles",className:"mailpoet-email-editor__styles-panel",header:(0,_.__)("Styles","mailpoet"),closeLabel:(0,_.__)("Close styles sidebar","mailpoet"),icon:Sa,scope:v,smallScreenTitle:(0,_.__)("No title","mailpoet"),...e},(0,i.createElement)(f.__experimentalNavigatorProvider,{initialPath:"/"},(0,i.createElement)(f.__experimentalNavigatorScreen,{path:"/"},(0,i.createElement)(Ma,null)),(0,i.createElement)(f.__experimentalNavigatorScreen,{path:"/typography"},(0,i.createElement)(Va,null)),(0,i.createElement)(f.__experimentalNavigatorScreen,{path:"/typography/text"},(0,i.createElement)(Wa,{element:"text"})),(0,i.createElement)(f.__experimentalNavigatorScreen,{path:"/typography/link"},(0,i.createElement)(Wa,{element:"link"})),(0,i.createElement)(f.__experimentalNavigatorScreen,{path:"/typography/heading"},(0,i.createElement)(Wa,{element:"heading"})),(0,i.createElement)(f.__experimentalNavigatorScreen,{path:"/typography/button"},(0,i.createElement)(Wa,{element:"button"})),(0,i.createElement)(f.__experimentalNavigatorScreen,{path:"/colors"},(0,i.createElement)(qa,null)),(0,i.createElement)(f.__experimentalNavigatorScreen,{path:"/layout"},(0,i.createElement)(Ya,null))))}));function Ka({contentRef:e}){const{onNavigateToEntityRecord:t,templateId:a}=(0,r.useSelect)((e=>{const{getEditorSettings:t,getCurrentTemplateId:a}=e(te.store);return{onNavigateToEntityRecord:t().onNavigateToEntityRecord,templateId:a()}}),[]),[n,l]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{const t=e=>{e.target.classList.contains("is-root-container")&&(l(!0),B("edit_template_blocks_notification_opened"))},a=e.current;return a?.addEventListener("dblclick",t),()=>{a?.removeEventListener("dblclick",t)}}),[e]),(0,i.createElement)(f.__experimentalConfirmDialog,{isOpen:n,confirmButtonText:(0,_.__)("Edit template"),onConfirm:()=>{l(!1),t({postId:a,postType:"wp_template"}),M("edit_template_blocks_notification_edit_template_button_clicked",{templateId:a})},onCancel:()=>{l(!1),M("edit_template_blocks_notification_cancel_button_clicked",{templateId:a})},size:"medium"},(0,_.__)("The block you’ve selected is part of a template that might be used in other emails. Are you sure you want to edit the template?","mailpoet"))}function Xa(e,t,a){return Math.min(Math.max(e,t),a)}function Qa({isEnabled:e=!0}={}){const t=(e=>{const{getEnabledClientIdsTree:t}=le(e);return t})((0,r.useSelect)(p.store)),{getBlockName:a,getBlockOrder:n}=(0,r.useSelect)(p.store),{selectBlock:l}=(0,r.useDispatch)(p.store);return(0,d.useRefEffect)((o=>{if(!e)return null;const i=e=>{(e.target===o||e.target.classList.contains("is-root-container"))&&((e,i)=>{const r=t().flatMap((({clientId:e})=>{const t=a(e);if("core/template-part"===t)return[];if("core/post-content"===t){const t=n(e);if(t.length)return t}return[e]})).reduce(((t,a)=>{const n=o.querySelector(`[data-block="${a}"]`);if(!n)return t;const l=n.getBoundingClientRect(),r=function(e,t,a){const n=e-Xa(e,Number(a.left),Number(a.right)),l=t-Xa(t,Number(a.top),Number(a.bottom));return Math.sqrt(n*n+l*l)}(Number(e),Number(i),l);return r<t.distance&&r<500?{clientId:a,distance:r}:t}),{clientId:null,distance:Number.POSITIVE_INFINITY}),s=r?.clientId||"";s&&l(s)})(e.clientX,e.clientY)};return o.addEventListener("click",i),()=>o.removeEventListener("click",i)}),[e])}const en="wp_block",tn=[en,"wp_template","wp_navigation","wp_template_part"];function an({styles:e,disableIframe:t=!1,iframeProps:a,contentRef:n,className:l}){var o;const{renderingMode:c,wrapperBlockName:m,wrapperUniqueId:u,deviceType:_,isFocusedEntity:g,layout:h}=(0,r.useSelect)((e=>{const{getCurrentPostId:t,getCurrentPostType:a,getEditorSettings:n,getRenderingMode:l,getDeviceType:o}=e(te.store),i=a(),r=l();let s;i===en?s="core/block":"post-only"===r&&(s="core/post-content");const c=n();return{renderingMode:r,isDesignPostType:tn.includes(i),wrapperBlockName:s,wrapperUniqueId:t(),deviceType:o(),isFocusedEntity:!!c.onNavigateToPreviousEntityRecord,postType:i,isPreview:c.__unstableIsPreviewMode,layout:c.__experimentalFeatures.layout}}),[]),y=(0,p.__experimentalUseResizeCanvas)(_),f=h,E=(0,s.useRef)(),b=(0,p.__unstableUseTypewriter)(),v=(0,d.useMergeRefs)([E,n,"post-only"===c?b:null,Qa({isEnabled:"template-locked"===c})]),w=!t||["Tablet","Mobile"].includes(_),k=[...null!==(o=e)&&void 0!==o?o:[],{css:`.is-root-container{display:flow-root; width:${"Desktop"===_?h.contentSize:"100%"}; margin: 0 auto;box-sizing: border-box;}`}];return(0,i.createElement)("div",{className:O()("editor-visual-editor","edit-post-visual-editor",l,{"has-padding":g,"is-iframed":w})},(0,i.createElement)(oe,{shouldIframe:w,contentRef:v,styles:k,height:"100%",iframeProps:{...a,style:{...a?.style,...y}}},(0,i.createElement)(p.RecursionProvider,{blockName:m,uniqueId:u},(0,i.createElement)(p.BlockList,{className:O()(`is-${_.toLowerCase()}-preview`,"has-global-padding"),layout:f,dropZoneElement:t?E.current:E.current?.parentNode,__unstableDisableDropZone:"template-locked"===c}),"template-locked"===c&&(0,i.createElement)(Ka,{contentRef:E}))))}function nn(){const[e,t]=(0,s.useState)(!1),{emailContentIsEmpty:a,emailHasEdits:n}=(0,r.useSelect)((e=>({emailContentIsEmpty:e(v).hasEmptyContent(),emailHasEdits:e(v).hasEdits()})),[]);return!a||n||e?null:(0,i.createElement)(It,{onSelectCallback:()=>t(!0)})}function ln(){B("editor_layout_loaded");const{isFullscreenActive:e,isSidebarOpened:t,initialSettings:a,previewDeviceType:n,isInserterSidebarOpened:l,isListviewSidebarOpened:o,canUserEditMedia:c,hasFixedToolbar:m,focusMode:d,styles:u}=(0,r.useSelect)((e=>({isFullscreenActive:e(v).isFeatureActive("fullscreenMode"),isSidebarOpened:e(v).isSidebarOpened(),isInserterSidebarOpened:e(te.store).isInserterOpened(),isListviewSidebarOpened:e(te.store).isListViewOpened(),initialSettings:e(v).getInitialEditorSettings(),previewDeviceType:e(v).getDeviceType(),canUserEditMedia:e(ae.store).canUser("create","media"),hasFixedToolbar:e(v).isFeatureActive("fixedToolbar"),focusMode:e(v).isFeatureActive("focusMode"),styles:e(v).getStyles()})),[]),{setIsInserterOpened:_}=(0,r.useDispatch)(te.store),[g]=st(),h=O()("edit-post-layout",{"is-sidebar-opened":t}),y=(0,s.useRef)(null),f={background:"Desktop"===n?u.color.background:"transparent",fontFamily:u.typography.fontFamily,transition:"all 0.3s ease 0s"},E={...a,mediaUpload:c?ce.uploadMedia:null,hasFixedToolbar:m,focusMode:d};return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(Qe,{isActive:e}),(0,i.createElement)(te.UnsavedChangesWarning,null),(0,i.createElement)(ct,null),(0,i.createElement)(ba,null),(0,i.createElement)(Dt,null),(0,i.createElement)(Ja,null),(0,i.createElement)(nn,null),(0,i.createElement)(lt,{className:h,header:(0,i.createElement)(ya,null),editorNotices:(0,i.createElement)(ka,null),content:(0,i.createElement)(i.Fragment,null,(0,i.createElement)(ka,null),(0,i.createElement)(p.BlockSelectionClearer,{className:"edit-post-visual-editor",style:f,onClick:()=>{l&&_(!1)}},(0,i.createElement)("div",{className:"visual-editor__email_content_wrapper"},(0,i.createElement)(an,{disableIframe:!1,styles:[...E.styles,...g],className:"has-global-padding",contentRef:y,iframeProps:{}})))),sidebar:(0,i.createElement)(Xe.Slot,{scope:v}),secondarySidebar:l&&(0,i.createElement)(Ea,null)||o&&(0,i.createElement)(fa,null)}),(0,i.createElement)(Ot,null))}function on({postId:e,postType:t,settings:a,initialEdits:n,...l}){const{currentPost:o,onNavigateToEntityRecord:c,onNavigateToPreviousEntityRecord:m}=function(e,t,a){const[n,l]=(0,s.useReducer)(((e,{type:t,post:a,previousRenderingMode:n})=>"push"===t?[...e,{post:a,previousRenderingMode:n}]:"pop"===t&&e.length>1?e.slice(0,-1):e),[{post:{postId:e,postType:t}}]),{post:o,previousRenderingMode:i}=n[n.length-1],{getRenderingMode:c}=(0,r.useSelect)(te.store),{setRenderingMode:m}=(0,r.useDispatch)(te.store),p=(0,s.useCallback)((e=>{l({type:"push",post:{postId:e.postId,postType:e.postType},previousRenderingMode:c()}),m(a)}),[c,m,a]),d=(0,s.useCallback)((()=>{l({type:"pop"}),i&&m(i)}),[m,i]);return{currentPost:o,onNavigateToEntityRecord:p,onNavigateToPreviousEntityRecord:n.length>1?d:void 0}}(e,t,"post-only"),{post:p,template:d}=(0,r.useSelect)((e=>{const{getEntityRecord:t}=e(ae.store),{getEditedPostTemplate:a}=e(v),n=t("postType",o.postType,o.postId);return{template:"wp_template"!==o.postType?a():null,post:n}}),[o.postType,o.postId]),u=(0,r.useSelect)((e=>{const{hasFinishedResolution:t,getBlockPatternsForPostType:a}=(e=>{const{hasFinishedResolution:t,getBlockPatternsForPostType:a}=le(e(ae.store));return{hasFinishedResolution:t,getBlockPatternsForPostType:a}})(e),n=a(o.postType);return t("getBlockPatterns")?n:void 0}),[o.postType]),_=(0,s.useMemo)((()=>({...a,onNavigateToEntityRecord:c,onNavigateToPreviousEntityRecord:m,defaultRenderingMode:"template-locked",supportsTemplateMode:!0,__experimentalBlockPatterns:u})),[a,c,m,u]);return!p||"wp_template"!==o.postType&&!d?(0,i.createElement)("div",{className:"spinner-container"},(0,i.createElement)(f.Spinner,{style:{width:"80px",height:"80px"}})):(0,i.createElement)(f.SlotFillProvider,null,(0,i.createElement)(te.EditorProvider,{settings:_,post:p,initialEdits:n,useSubRegistry:!1,__unstableTemplate:d,...l},(0,i.createElement)(te.ErrorBoundary,null,(0,i.createElement)(ln,null),(0,i.createElement)(te.PostLockedModal,null))))}const rn=window.wp.dataControls,sn=window.wp.apiFetch;var cn=a.n(sn);const mn=window.wp.htmlEntities,pn=e=>({registry:t})=>t.dispatch(he.store).toggle(v,e),dn=e=>({registry:t})=>{t.dispatch(te.store).setDeviceType(e)};function un(e){return{type:"CHANGE_PREVIEW_STATE",state:{isModalOpened:e}}}function gn(e,t={}){return{type:"CHANGE_PERSONALIZATION_TAGS_STATE",state:{isModalOpened:e,...t}}}function hn(e){return{type:"CHANGE_PREVIEW_STATE",state:{toEmail:e}}}const yn=(e=w)=>({registry:t})=>t.dispatch(De).enableComplementaryArea(v,e),fn=()=>({registry:e})=>e.dispatch(De).disableComplementaryArea(v);function En(e){return{type:"TOGGLE_SETTINGS_SIDEBAR_ACTIVE_TAB",state:{activeTab:e}}}function*bn(){const e=(0,r.select)(v).getEmailPostId(),t=yield(0,r.dispatch)(ae.store).saveEditedEntityRecord("postType","mailpoet_email",e,{throwOnError:!0});t.then((()=>{(0,r.dispatch)(Zt.store).createErrorNotice((0,_.__)("Email saved!","mailpoet"),{type:"snackbar",isDismissible:!0,context:"email-editor"})})),t.catch((()=>{(0,r.dispatch)(Zt.store).createErrorNotice((0,_.__)("The email could not be saved. Please, clear browser cache and reload the page. If the problem persists, duplicate the email and try again.","mailpoet"),{type:"default",isDismissible:!0,context:"email-editor"})}))}function*vn(e,t){const a=(0,r.select)(v).getEmailPostId(),n=(0,r.select)(ae.store).getEditedEntityRecord("postType","mailpoet_email",a),l=n?.mailpoet_data||{};yield(0,r.dispatch)(ae.store).editEntityRecord("postType","mailpoet_email",a,{mailpoet_data:{...l,[e]:t}})}const wn=e=>async({registry:t})=>{const a=t.select(v).getEmailPostId();t.dispatch(ae.store).editEntityRecord("postType","mailpoet_email",a,{template:e})};function*kn(e,t){if(!(0,r.select)(v).getPreviewState().isSendingPreviewEmail){yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:null,isSendingPreviewEmail:!0}};try{const a=(0,r.select)(v).getEmailPostId();yield(0,rn.apiFetch)({path:"/mailpoet-email-editor/v1/send_preview_email",method:"POST",data:{newsletterId:e,email:t,postId:a}}),yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:ta.SUCCESS,isSendingPreviewEmail:!1}},M("sent_preview_email",{postId:a,email:t})}catch(e){M("sent_preview_email_error",{email:t}),yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:ta.ERROR,isSendingPreviewEmail:!1}}}}}function Sn(e){return async({registry:t})=>{try{const a=t.select(ae.store).getEntityConfig("postType",e.type),n=(0,ea.addQueryArgs)(`${a.baseURL}/${e.id}`,{context:"edit",source:"theme"}),l=await cn()({path:n}),o=({blocks:e=[]})=>(0,V.__unstableSerializeAndClean)(e),i=(0,V.parse)(l?.content?.raw);await t.dispatch(ae.store).editEntityRecord("postType",e.type,l.id,{content:o,blocks:i,source:"theme"}),await t.dispatch(ae.store).saveEditedEntityRecord("postType",e.type,e.id,{}),t.dispatch(Zt.store).createSuccessNotice((0,_.sprintf)(/* translators: The template/part's name. */ /* translators: The template/part's name. */
(0,_.__)('"%s" reset.',"mailpoet"),(0,mn.decodeEntities)(e.title)),{type:"snackbar",id:"edit-site-template-reverted"})}catch(e){t.dispatch(Zt.store).createErrorNotice((0,_.__)("An error occurred while reverting the template.","mailpoet"),{type:"snackbar"})}}}function xn(e){return{type:"SET_IS_FETCHING_PERSONALIZATION_TAGS",state:{isFetching:e}}}function Cn(e){return{type:"SET_PERSONALIZATION_TAGS_LIST",state:{list:e}}}function Tn(){const e=new URLSearchParams(window.location.search),t=parseInt(e.get("post"),10);return{inserterSidebar:{isOpened:!1},listviewSidebar:{isOpened:!1},settingsSidebar:{activeTab:w},postId:t,editorSettings:window.MailPoetEmailEditor.editor_settings,theme:window.MailPoetEmailEditor.editor_theme,styles:{globalStylesPostId:window.MailPoetEmailEditor.user_theme_post_id},autosaveInterval:60,cdnUrl:window.MailPoetEmailEditor.cdn_url,isPremiumPluginActive:window.MailPoetEmailEditor.is_premium_plugin_active,urls:window.MailPoetEmailEditor.urls,preview:{deviceType:"Desktop",toEmail:window.MailPoetEmailEditor.current_wp_user_email,isModalOpened:!1,isSendingPreviewEmail:!1,sendingPreviewStatus:null},personalizationTags:{list:[],isFetching:!1}}}function Nn(e,t){switch(t.type){case"CHANGE_PREVIEW_STATE":return{...e,preview:{...e.preview,...t.state}};case"CHANGE_PERSONALIZATION_TAGS_STATE":case"SET_IS_FETCHING_PERSONALIZATION_TAGS":case"SET_PERSONALIZATION_TAGS_LIST":return{...e,personalizationTags:{...e.personalizationTags,...t.state}};case"TOGGLE_SETTINGS_SIDEBAR_ACTIVE_TAB":return{...e,settingsSidebar:{...e.settingsSidebar,activeTab:t.state.activeTab}};case"SET_PERSONALIZATION_TAGS":return{...e,personalizationTags:{...e.personalizationTags,list:t.personalizationTags}};default:return e}}function Pn(e){return e?.content&&"function"==typeof e.content?e.content(e):e?.blocks?(0,V.serialize)(e.blocks):e?.content?e.content:""}const In=(0,r.createRegistrySelector)((e=>(t,a)=>!!e(he.store).get(v,a))),Mn=(0,r.createRegistrySelector)((e=>()=>!!e(De).getActiveComplementaryArea(v))),Bn=(0,r.createRegistrySelector)((e=>()=>{const t=e(v).getEmailPostId();return!!e(ae.store).hasEditsForEntityRecord("postType","mailpoet_email",t)})),An=(0,r.createRegistrySelector)((e=>()=>{const t=e(v).getEmailPostId();return!!e(ae.store).getEntityRecord("postType","mailpoet_email",t)})),Ln=(0,r.createRegistrySelector)((e=>()=>{const t=e(v).getEmailPostId();return!!e(ae.store).isSavingEntityRecord("postType","mailpoet_email",t)})),Rn=(0,r.createRegistrySelector)((e=>()=>{const t=e(v).getEmailPostId(),a=e(ae.store).getEntityRecord("postType","mailpoet_email",t);if(!a)return!0;const{content:n,mailpoet_data:l,title:o}=a;return!(n.raw||l.subject||l.preheader||o.raw)})),zn=(0,r.createRegistrySelector)((e=>()=>{const t=e(v).getEmailPostId(),a=e(ae.store).getEntityRecord("postType","mailpoet_email",t);if(!a)return!0;const{content:n}=a;return!n.raw})),Fn=(0,r.createRegistrySelector)((e=>()=>{const t=e(v).getEmailPostId(),a=e(ae.store).getEntityRecord("postType","mailpoet_email",t);return!!a&&"sent"===a.status})),jn=(0,r.createRegistrySelector)((e=>()=>{const t=e(v).getEmailPostId(),a=e(ae.store).getEditedEntityRecord("postType","mailpoet_email",t);return a?Pn(a):""})),Dn=(0,r.createRegistrySelector)((e=>()=>e(ae.store).getEntityRecords("postType","mailpoet_email",{per_page:30,status:"publish,sent"})?.filter((e=>""!==e?.content?.raw))||[])),On=(0,r.createRegistrySelector)((e=>()=>{const t=e(te.store).getEditedPostAttribute("template");if(t){const a=e(ae.store).getEntityRecords("postType","wp_template",{per_page:-1})?.find((e=>e.slug===t));return a?e(ae.store).getEditedEntityRecord("postType","wp_template",a.id):a}const a=e(ae.store).getDefaultTemplateId({slug:"email-general"});return e(ae.store).getEditedEntityRecord("postType","wp_template",a)})),Vn=(0,r.createRegistrySelector)((e=>()=>{if("wp_template"===e(te.store).getCurrentPostType()){const t=e(te.store).getCurrentPostId();return e(ae.store).getEditedEntityRecord("postType","wp_template",t)}return On()})),Hn=()=>{const e=Vn();return e?Pn(e):""},Gn=(0,r.createRegistrySelector)((e=>()=>{const t=e(v).getGlobalStylesPostId();return t?e(ae.store).getEditedEntityRecord("postType","wp_global_styles",t):On()})),$n=(0,r.createRegistrySelector)((e=>()=>e(ae.store).getEntityRecords("postType","wp_template",{per_page:-1,post_type:"mailpoet_email"})?.filter((e=>e.post_types.includes("mailpoet_email")))));function Un(e){return e.postId}function Wn(e){return e.settingsSidebar.activeTab}function qn(e){return e.editorSettings}function Zn(e){return e.editorSettings.__experimentalFeatures.color.palette}function Yn(e){return e.preview}function Jn(e){return e.personalizationTags}function Kn(e){return e.personalizationTags.list}const Xn=(0,r.createRegistrySelector)((e=>()=>e(te.store).getDeviceType()));function Qn(e){return e.theme.styles}function el(e){return e.autosaveInterval}function tl(e){return e.cdnUrl}function al(e){return e.isPremiumPluginActive}function nl(e){return e.theme}function ll(e){return e.styles.globalStylesPostId}function ol(e){return e.urls}function*il(){const e=yield(0,r.select)(v),t=e.personalizationTags?.isFetching;if(!t){yield xn(!0);try{const e=yield(0,rn.apiFetch)({path:"/mailpoet-email-editor/v1/get_personalization_tags",method:"GET"});yield Cn(e.result)}finally{yield xn(!1)}}}const rl=window.wp.keyboardShortcuts;function sl(){const{undo:e,redo:t}=(0,r.useDispatch)(ae.store),{isSidebarOpened:a,hasEdits:n,isSaving:l}=(0,r.useSelect)((e=>({isSidebarOpened:e(v).isSidebarOpened(),isSaving:e(v).isSaving(),hasEdits:e(v).hasEdits()}))),{openSidebar:o,closeSidebar:i,saveEditedEmail:c,toggleFeature:m}=(0,r.useDispatch)(v),{registerShortcut:p}=(0,r.useDispatch)(rl.store);return(0,s.useEffect)((()=>{p({name:"mailpoet/email-editor/toggle-fullscreen",category:"global",description:(0,_.__)("Toggle fullscreen mode.","mailpoet"),keyCombination:{modifier:"secondary",character:"f"}}),p({name:"mailpoet/email-editor/toggle-sidebar",category:"global",description:(0,_.__)("Show or hide the settings sidebar.","mailpoet"),keyCombination:{modifier:"primaryShift",character:","}}),p({name:"mailpoet/email-editor/save",category:"global",description:(0,_.__)("Save your changes.","mailpoet"),keyCombination:{modifier:"primary",character:"s"}}),p({name:"mailpoet/email-editor/undo",category:"block",description:(0,_.__)("Undo your last changes."),keyCombination:{modifier:"primary",character:"z"}}),p({name:"mailpoet/email-editor/redo",category:"block",description:(0,_.__)("Redo your last undo."),keyCombination:{modifier:"primaryShift",character:"z"}})}),[p]),(0,rl.useShortcut)("mailpoet/email-editor/toggle-fullscreen",(()=>{M("keyboard_shortcuts_toggle_fullscreen"),m("fullscreenMode")})),(0,rl.useShortcut)("mailpoet/email-editor/toggle-sidebar",(e=>{M("keyboard_shortcuts_toggle_sidebar"),e.preventDefault(),a?i():o()})),(0,rl.useShortcut)("mailpoet/email-editor/save",(e=>{M("keyboard_shortcuts_save"),e.preventDefault(),n&&!l&&c()})),(0,rl.useShortcut)("mailpoet/email-editor/undo",(t=>{e(),t.preventDefault()})),(0,rl.useShortcut)("mailpoet/email-editor/redo",(e=>{t(),e.preventDefault()})),null}const cl=e=>{(0,c.doAction)("mailpoet_email_editor_events",e.detail)};window.addEventListener("unload",(function(){N&&I.removeEventListener(P,cl)}));const ml=(0,c.applyFilters)("mailpoet_email_editor_wrap_editor_component",(function(){const{postId:e,settings:t}=(0,r.useSelect)((e=>({postId:e(v).getEmailPostId(),settings:e(v).getInitialEditorSettings()})),[]);return(0,i.createElement)(s.StrictMode,null,(0,i.createElement)(sl,null),(0,i.createElement)(on,{initialEdits:[],postId:e,postType:"mailpoet_email",settings:t}))}));function pl(e){const t=document.getElementById(e);t&&(N&&I.addEventListener(P,cl),(()=>{const e=(0,r.createReduxStore)(v,{actions:n,controls:rn.controls,selectors:l,resolvers:o,reducer:Nn,initialState:Tn()});(0,r.register)(e)})(),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/layout/addAttribute",K),(0,c.addFilter)("editor.BlockListBlock","mailpoet-email-editor/with-layout-styles",ee),(0,c.addFilter)("editor.BlockEdit","mailpoet-email-editor/with-inspector-controls",X),(0,c.addFilter)("editor.BlockEdit","mailpoet-email-editor/deactivate-stack-on-mobile",u),(0,c.addFilter)("editor.BlockEdit","mailpoet-email-editor/hide-expand-on-click",h),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/deactivate-image-filter",((e,t)=>"core/image"===t?{...e,supports:{...e.supports,filter:{duetone:!1}}}:e)),(0,y.unregisterFormatType)("core/image"),(0,y.unregisterFormatType)("core/code"),(0,y.unregisterFormatType)("core/language"),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/disable-columns-layout",((e,t)=>"core/columns"===t||"core/column"===t?{...e,supports:{...e.supports,layout:!1}}:e)),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/disable-group-variations",((e,t)=>"core/group"===t?{...e,variations:e.variations.filter((e=>"group"===e.name)),supports:{...e.supports,layout:!1}}:e)),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-button",((e,t)=>"core/button"===t?{...e,styles:[]}:e)),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-buttons",((e,t)=>"core/buttons"===t?{...e,supports:{...e.supports,layout:!1,__experimentalEmailFlexLayout:!0}}:e)),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-column",((e,t)=>"core/column"===t?{...e,supports:{...e.supports,background:{backgroundImage:!0}}}:e)),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-columns",((e,t)=>"core/columns"===t?{...e,supports:{...e.supports,background:{backgroundImage:!0}}}:e)),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-post-content",((e,t)=>{return"core/post-content"===t?{...e,edit:(a=e.edit,function({context:e,__unstableLayoutClassNames:t}){const{postId:n,postType:l}=e;return n&&l?(0,i.createElement)(a,{context:e,__unstableLayoutClassNames:t}):(0,i.createElement)(g,{layoutClassNames:t})})}:e;var a})),(0,y.registerFormatType)("mailpoet-email-editor/shortcode",{name:"mailpoet-email-editor/shortcode",title:(0,_.__)("Personalization Tags","mailpoet"),className:"mailpoet-email-editor-personalization-tags",tagName:"span",attributes:{},edit:F}),(0,y.registerFormatType)("mailpoet-email-editor/link-shortcode",{name:"mailpoet-email-editor/link-shortcode",title:(0,_.__)("Personalization Tags Link","mailpoet"),className:"mailpoet-email-editor__personalization-tags-link",tagName:"a",attributes:{"data-link-href":"data-link-href",contenteditable:"contenteditable",style:"style"},edit:null}),(0,c.addFilter)("editor.BlockEdit","mailpoet-email-editor/with-live-content-update",j),(0,c.addFilter)("blocks.registerBlockType","mailpoet-email-editor/block-support",(e=>e.supports?.shadow?{...e,supports:{...e.supports,shadow:!1}}:e)),(0,m.registerCoreBlocks)(),(0,c.addFilter)("editor.MediaUpload","mailpoet/email-editor/replace-media-upload",(()=>ce.MediaUpload)),(0,s.createRoot)(t).render((0,i.createElement)(ml,null)))}window.addEventListener("DOMContentLoaded",(()=>{pl("mailpoet-email-editor")}))})()})();